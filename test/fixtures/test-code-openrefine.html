<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Language" content="en-us">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Snyk test report</title>
  <meta name="description" content=" known vulnerabilities found in .">
  <base target="_blank">
  <link rel="icon" type="image/png" href="https://res.cloudinary.com/snyk/image/upload/v1468845142/favicon/favicon.png"
    sizes="194x194">
  <link rel="shortcut icon" href="https://res.cloudinary.com/snyk/image/upload/v1468845142/favicon/favicon.ico">
  <style type="text/css">
  
    body {
      -moz-font-feature-settings: "pnum";
      -webkit-font-feature-settings: "pnum";
      font-variant-numeric: proportional-nums;
      display: flex;
      flex-direction: column;
      font-feature-settings: "pnum";
      font-size: 100%;
      line-height: 1.5;
      min-height: 100vh;
      -webkit-text-size-adjust: 100%;
      margin: 0;
      padding: 0;
      background-color: #F5F5F5;
      font-family: 'Arial', 'Helvetica', Calibri, sans-serif;
    }
  
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      font-weight: 500;
    }
  
    a,
    a:link,
    a:visited {
      border-bottom: 1px solid #4b45a9;
      text-decoration: none;
      color: #4b45a9;
    }
  
    a:hover,
    a:focus,
    a:active {
      border-bottom: 1px solid #4b45a9;
    }
  
    hr {
      border: none;
      margin: 1em 0;
      border-top: 1px solid #c5c5c5;
    }
  
    ul {
      padding: 0 1em;
      margin: 1em 0;
    }
  
    code {
      background-color: #EEE;
      color: #333;
      padding: 0.25em 0.5em;
      border-radius: 0.25em;
    }
  
    pre {
      background-color: rgb(255, 255, 255);
      font-family: monospace;
      padding: 0.5em 1em 0.75em;
      border-radius: 0.25em;
      font-size: 14px;
    }
  
    pre code {
      padding: 0;
      font-family: monospace;
      background-color: rgb(255, 255, 255);
      color: rgb(0, 0, 0);
      display: block;
      background: none;
      white-space: pre-wrap;
      overflow-x: scroll;
      max-width: 100%;
      min-width: 100px;
    }
  
    a code {
      border-radius: .125rem .125rem 0 0;
      padding-bottom: 0;
      color: #4b45a9;
    }
  
    a[href^="http://"]:after,
    a[href^="https://"]:after {
      background-image: linear-gradient(transparent,transparent),url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20112%20109%22%3E%3Cg%20id%3D%22Page-1%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cg%20id%3D%22link-external%22%3E%3Cg%20id%3D%22arrow%22%3E%3Cpath%20id%3D%22Line%22%20stroke%3D%22%234B45A9%22%20stroke-width%3D%2215%22%20d%3D%22M88.5%2021l-43%2042.5%22%20stroke-linecap%3D%22square%22%2F%3E%3Cpath%20id%3D%22Triangle%22%20fill%3D%22%234B45A9%22%20d%3D%22M111.2%200v50L61%200z%22%2F%3E%3C%2Fg%3E%3Cpath%20id%3D%22square%22%20fill%3D%22%234B45A9%22%20d%3D%22M66%2015H0v94h94V44L79%2059v35H15V30h36z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E");
      background-repeat: no-repeat;
      background-size: .75rem;
      content: "";
      display: inline-block;
      height: .75rem;
      margin-left: .25rem;
      width: .75rem;
    }
  
  
  /* Layout */
  
    [class*=layout-container] {
      margin: 0 auto;
      max-width: 71.25em;
      padding: 1.9em 1.3em;
      position: relative;
    }
    .layout-container--short {
      padding-top: 0;
      padding-bottom: 0;
      max-width: 48.75em;
    }
  
    .layout-container--short:after {
      display: block;
      content: "";
      clear: both;
    }
  
  /* Header */
  
    .header {
      padding-bottom: 1px;
    }
  
    .paths {
      margin-left: 8px;
    }
    .header-wrap {
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      padding-top: 2em;
    }
    .project__header {
      background-color: #4b45a9;
      color: #fff;
      margin-bottom: -1px;
      padding-top: 1em;
      padding-bottom: 0.25em;
      border-bottom: 2px solid #BBB;
    }
  
    .project__header__title {
      overflow-wrap: break-word;
      word-wrap: break-word;
      word-break: break-all;
      margin-bottom: .1em;
      margin-top: 0;
    }
  
    .timestamp {
      float: right;
      clear: none;
      margin-bottom: 0;
    }
  
    .meta-counts {
      clear: both;
      display: block;
      flex-wrap: wrap;
      justify-content: space-between;
      margin: 0 0 1.5em;
      color: #fff;
      clear: both;
      font-size: 1.1em;
    }
  
    .meta-count {
      display: block;
      flex-basis: 100%;
      margin: 0 1em 1em 0;
      float: left;
      padding-right: 1em;
      border-right: 2px solid #fff;
    }
  
    .meta-count:last-child {
      border-right: 0;
      padding-right: 0;
      margin-right: 0;
    }
  
  /* Card */
  
    .card {
      background-color: #fff;
      border: 1px solid #c5c5c5;
      border-radius: .25rem;
      margin: 0 0 2em 0;
      position: relative;
      min-height: 40px;
      padding: 1.5em;
    }
  
    .card .label {
      background-color: #767676;
      border: 2px solid #767676;
      color: white;
      padding: 0.25rem 0.75rem;
      font-size: 0.875rem;
      text-transform: uppercase;
      display: inline-block;
      margin: 0;
      border-radius: 0.25rem;
    }
  
    .card .label__text {
      vertical-align: text-top;
        font-weight: bold;
    }
  
    .card .label--critical {
      background-color: #AB1A1A;
      border-color: #AB1A1A;
    }
  
    .card .label--high {
      background-color: #CE5019;
      border-color: #CE5019;
    }
  
    .card .label--medium {
      background-color: #D68000;
      border-color: #D68000;
    }
  
    .card .label--low {
      background-color: #88879E;
      border-color: #88879E;
    }
  
    .severity--low {
      border-color: #88879E;
    }
  
    .severity--medium {
      border-color: #D68000;
    }
  
    .severity--high {
      border-color: #CE5019;
    }
  
    .severity--critical {
      border-color: #AB1A1A;
    }
  
    .card--vuln {
      padding-top: 4em;
    }
  
    .card--vuln .label {
      left: 0;
      position: absolute;
      top: 1.1em;
      padding-left: 1.9em;
      padding-right: 1.9em;
      border-radius: 0 0.25rem 0.25rem 0;
    }
  
    .card--vuln .card__section h2 {
      font-size: 22px;
      margin-bottom: 0.5em;
    }
  
    .card--vuln .card__section p {
      margin: 0 0 0.5em 0;
    }
  
    .card--vuln .card__meta {
      padding: 0 0 0 1em;
      margin: 0;
      font-size: 1.1em;
    }
  
    .card .card__meta__paths {
      font-size: 0.9em;
    }
  
    .card--vuln .card__title {
      font-size: 28px;
      margin-top: 0;
    }
  
    .card--vuln .card__cta p {
      margin: 0;
      text-align: right;
    }
  
    .source-panel {
      clear: both;
      display: flex;
      justify-content: flex-start;
      flex-direction: column;
      align-items: flex-start;
      padding: 0.5em 0;
      width: fit-content;
    }
  
  
  
  </style>
  <style type="text/css">
    .metatable {
      text-size-adjust: 100%;
      -webkit-font-smoothing: antialiased;
      -webkit-box-direction: normal;
      color: inherit;
      font-feature-settings: "pnum";
      box-sizing: border-box;
      background: transparent;
      border: 0;
      font: inherit;
      font-size: 100%;
      margin: 0;
      outline: none;
      padding: 0;
      text-align: left;
      text-decoration: none;
      vertical-align: baseline;
      z-index: auto;
      margin-top: 12px;
      border-collapse: collapse;
      border-spacing: 0;
      font-variant-numeric: tabular-nums;
      max-width: 51.75em;
    }
  
    tbody {
      text-size-adjust: 100%;
      -webkit-font-smoothing: antialiased;
      -webkit-box-direction: normal;
      color: inherit;
      font-feature-settings: "pnum";
      border-collapse: collapse;
      border-spacing: 0;
      box-sizing: border-box;
      background: transparent;
      border: 0;
      font: inherit;
      font-size: 100%;
      margin: 0;
      outline: none;
      padding: 0;
      text-align: left;
      text-decoration: none;
      vertical-align: baseline;
      z-index: auto;
      display: flex;
      flex-wrap: wrap;
    }
  
    .meta-row {
      text-size-adjust: 100%;
      -webkit-font-smoothing: antialiased;
      -webkit-box-direction: normal;
      color: inherit;
      font-feature-settings: "pnum";
      border-collapse: collapse;
      border-spacing: 0;
      box-sizing: border-box;
      background: transparent;
      border: 0;
      font: inherit;
      font-size: 100%;
      outline: none;
      text-align: left;
      text-decoration: none;
      vertical-align: baseline;
      z-index: auto;
      display: flex;
      align-items: start;
      border-top: 1px solid #d3d3d9;
      padding: 8px 0 0 0;
      border-bottom: none;
      margin: 8px;
      width: 47.75%;
    }
  
    .meta-row-label {
      text-size-adjust: 100%;
      -webkit-font-smoothing: antialiased;
      -webkit-box-direction: normal;
      font-feature-settings: "pnum";
      border-collapse: collapse;
      border-spacing: 0;
      color: #4c4a73;
      box-sizing: border-box;
      background: transparent;
      border: 0;
      font: inherit;
      margin: 0;
      outline: none;
      text-decoration: none;
      z-index: auto;
      align-self: start;
      flex: 1;
      font-size: 1rem;
      line-height: 1.5rem;
      padding: 0;
      text-align: left;
      vertical-align: top;
      text-transform: none;
      letter-spacing: 0;
    }
  
    .meta-row-value {
      text-size-adjust: 100%;
      -webkit-font-smoothing: antialiased;
      -webkit-box-direction: normal;
      color: inherit;
      font-feature-settings: "pnum";
      border-collapse: collapse;
      border-spacing: 0;
      word-break: break-word;
      box-sizing: border-box;
      background: transparent;
      border: 0;
      font: inherit;
      font-size: 100%;
      margin: 0;
      outline: none;
      padding: 0;
      text-align: right;
      text-decoration: none;
      vertical-align: baseline;
      z-index: auto;
    }
  </style>
</head>


<body class="section-projects">
  <main class="layout-stacked">
        <div class="layout-stacked__header header">
          <header class="project__header">
            <div class="layout-container">
              <a class="brand" href="https://snyk.io" title="Snyk">
                <svg width="68px" height="35px" viewBox="0 0 68 35" version="1.1" xmlns="http://www.w3.org/2000/svg" role="img">
                  <title>Snyk - Snyk Code</title>
                  <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                    <g fill="#fff">
                      <path d="M5.732,27.278 C3.445,27.278 1.589,26.885 0,26.124 L0.483,22.472 C2.163,23.296 4.056,23.689 5.643,23.689 C6.801,23.689 7.563,23.295 7.563,22.599 C7.563,20.594 0.333,21.076 0.333,15.839 C0.333,12.491 3.407,10.729 7.259,10.729 C9.179,10.729 11.161,11.249 12.444,11.704 L11.924,15.294 C10.577,14.774 8.747,14.291 7.222,14.291 C6.282,14.291 5.518,14.621 5.518,15.231 C5.518,17.208 12.903,16.815 12.903,21.925 C12.903,25.325 9.877,27.277 5.733,27.277 L5.732,27.278 Z M25.726,26.936 L25.726,17.894 C25.726,15.827 24.811,14.85 23.069,14.85 C22.219,14.85 21.329,15.09 20.719,15.46 L20.719,26.936 L15.352,26.936 L15.352,11.262 L20.602,10.83 L20.474,13.392 L20.652,13.392 C21.784,11.87 23.702,10.716 25.992,10.716 C28.736,10.716 31.112,12.416 31.112,16.436 L31.112,26.936 L25.724,26.936 L25.726,26.936 Z M61.175,26.936 L56.879,19.479 L56.446,19.479 L56.446,26.935 L51.082,26.935 L51.082,8.37 L56.447,0 L56.447,17.323 C57.515,16.017 61.112,11.059 61.112,11.059 L67.732,11.059 L61.454,17.689 L67.949,26.95 L61.175,26.95 L61.175,26.938 L61.175,26.936 Z M44.13,11.11 L41.93,18.262 C41.5,19.606 41.08,22.079 41.08,22.079 C41.08,22.079 40.75,19.516 40.292,18.172 L37.94,11.108 L31.928,11.108 L38.462,26.935 C37.572,29.04 36.199,30.815 34.369,30.815 C34.039,30.815 33.709,30.802 33.389,30.765 L31.255,34.061 C31.928,34.441 33.212,34.835 34.737,34.835 C38.703,34.835 41.359,31.627 43.215,26.885 L49.443,11.108 L44.132,11.108 L44.13,11.11 Z"></path>
                    </g>
                  </g>
                </svg>
              </a>
              <div class="header-wrap">
                  <h1 class="project__header__title">Snyk Code report</h1>
    
                <p class="timestamp">February 24th 2022, 12:21:07 pm</p>
              </div>
                <div class="source-panel">
                    <span>Scanned the following languages:</span>
                    <ul>
                      <li class="paths">Language: XML Number of files: (37)</li><li class="paths">Language: Java Number of files: (1010)</li><li class="paths">Language: JavaScript Number of files: (166)</li><li class="paths">Language: HTML Number of files: (81)</li>
                    </ul>            
                </div>
    
                <div class="meta-counts">
                  <div class="meta-count"><span>27</span> <span>total issues</span></div>
                </div><!-- .meta-counts -->
            </div><!-- .layout-container--short -->
          </header><!-- .project__header -->
        </div><!-- .layout-stacked__header -->

    <div class="layout-container" style="padding-top: 35px;">
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--high">
                      <span class="label__text">high severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Path Traversal</p>
                          <!--Rule ID: java/PT</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-23</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/ImportingUtilities.java (line : 254)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          250:                     
          251:                     progress.setProgress(&quot;Uploading pasted clipboard text&quot;,
          252:                         calculateProgressPercent(update.totalExpectedSize, update.totalRetrievedSize));
          253:                     
          254:                     JSONUtilities.safePut(fileRecord, &quot;size&quot;, saveStreamToFile(stream, file, null));
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Unsanitized input from a zip file flows into java.io.FileOutputStream, where it is used as a path. This may result in a Path Traversal vulnerability and allow an attacker to write to arbitrary files.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          670:             try {
          671:                 ZipEntry ze;
          672:                 while (!progress.isCanceled() &amp;&amp; (ze &#x3D; zis.getNextEntry()) !&#x3D; null) {
          673:                     if (!ze.isDirectory()) {
          674:                         String fileName2 &#x3D; ze.getName();
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          670:             try {
          671:                 ZipEntry ze;
          672:                 while (!progress.isCanceled() &amp;&amp; (ze &#x3D; zis.getNextEntry()) !&#x3D; null) {
          673:                     if (!ze.isDirectory()) {
          674:                         String fileName2 &#x3D; ze.getName();
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          670:             try {
          671:                 ZipEntry ze;
          672:                 while (!progress.isCanceled() &amp;&amp; (ze &#x3D; zis.getNextEntry()) !&#x3D; null) {
          673:                     if (!ze.isDirectory()) {
          674:                         String fileName2 &#x3D; ze.getName();
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          671:                 ZipEntry ze;
          672:                 while (!progress.isCanceled() &amp;&amp; (ze &#x3D; zis.getNextEntry()) !&#x3D; null) {
          673:                     if (!ze.isDirectory()) {
          674:                         String fileName2 &#x3D; ze.getName();
          675:                         File file2 &#x3D; allocateFile(rawDataDir, fileName2);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          436:         String location &#x3D; file.getAbsolutePath().substring(dir.getAbsolutePath().length());
          437:         return (location.startsWith(File.separator)) ? location.substring(1) : location;
          438:     }
          439:     
          440:     static public File allocateFile(File dir, String name) {
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          437:         return (location.startsWith(File.separator)) ? location.substring(1) : location;
          438:     }
          439:     
          440:     static public File allocateFile(File dir, String name) {
          441:         int q &#x3D; name.indexOf(&#x27;?&#x27;);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          439:     
          440:     static public File allocateFile(File dir, String name) {
          441:         int q &#x3D; name.indexOf(&#x27;?&#x27;);
          442:         if (q &gt; 0) {
          443:             name &#x3D; name.substring(0, q);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          448:         if (!file.toPath().normalize().startsWith(dir.toPath().normalize() + File.separator)) {
          449:             throw new IllegalArgumentException(&quot;Zip archives with files escaping their root directory are not allowed.&quot;);
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          449:             throw new IllegalArgumentException(&quot;Zip archives with files escaping their root directory are not allowed.&quot;);
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          449:             throw new IllegalArgumentException(&quot;Zip archives with files escaping their root directory are not allowed.&quot;);
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          449:             throw new IllegalArgumentException(&quot;Zip archives with files escaping their root directory are not allowed.&quot;);
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          455:         int index &#x3D; 2;
          456:         while (file.exists()) {
          457:             file &#x3D; new File(dir, prefix + &quot;-&quot; + index++ + suffix);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          455:         int index &#x3D; 2;
          456:         while (file.exists()) {
          457:             file &#x3D; new File(dir, prefix + &quot;-&quot; + index++ + suffix);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          455:         int index &#x3D; 2;
          456:         while (file.exists()) {
          457:             file &#x3D; new File(dir, prefix + &quot;-&quot; + index++ + suffix);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          455:         int index &#x3D; 2;
          456:         while (file.exists()) {
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          456:         while (file.exists()) {
          457:             file &#x3D; new File(dir, prefix + &quot;-&quot; + index++ + suffix);
          458:         }
          459:         
          460:         file.getParentFile().mkdirs();
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          458:         }
          459:         
          460:         file.getParentFile().mkdirs();
          461:         
          462:         return file;
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          671:                 ZipEntry ze;
          672:                 while (!progress.isCanceled() &amp;&amp; (ze &#x3D; zis.getNextEntry()) !&#x3D; null) {
          673:                     if (!ze.isDirectory()) {
          674:                         String fileName2 &#x3D; ze.getName();
          675:                         File file2 &#x3D; allocateFile(rawDataDir, fileName2);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          681:                         JSONUtilities.safePut(fileRecord2, &quot;declaredEncoding&quot;, (String) null);
          682:                         JSONUtilities.safePut(fileRecord2, &quot;declaredMimeType&quot;, (String) null);
          683:                         JSONUtilities.safePut(fileRecord2, &quot;fileName&quot;, fileName2);
          684:                         JSONUtilities.safePut(fileRecord2, &quot;archiveFileName&quot;, JSONUtilities.getString(archiveFileRecord, &quot;fileName&quot;, null));
          685:                         JSONUtilities.safePut(fileRecord2, &quot;location&quot;, getRelativePath(file2, rawDataDir));
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          431:             calculateProgressPercent(update.totalExpectedSize, update.totalRetrievedSize));
          432:         return postProcessRetrievedFile(rawDataDir, file, fileRecord, fileRecords, progress);
          433:     }
          434:     
          435:     static public String getRelativePath(File file, File dir) {
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          432:         return postProcessRetrievedFile(rawDataDir, file, fileRecord, fileRecords, progress);
          433:     }
          434:     
          435:     static public String getRelativePath(File file, File dir) {
          436:         String location &#x3D; file.getAbsolutePath().substring(dir.getAbsolutePath().length());
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          250:                     
          251:                     progress.setProgress(&quot;Uploading pasted clipboard text&quot;,
          252:                         calculateProgressPercent(update.totalExpectedSize, update.totalRetrievedSize));
          253:                     
          254:                     JSONUtilities.safePut(fileRecord, &quot;size&quot;, saveStreamToFile(stream, file, null));
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          250:                     
          251:                     progress.setProgress(&quot;Uploading pasted clipboard text&quot;,
          252:                         calculateProgressPercent(update.totalExpectedSize, update.totalRetrievedSize));
          253:                     
          254:                     JSONUtilities.safePut(fileRecord, &quot;size&quot;, saveStreamToFile(stream, file, null));
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          522:         
          523:         abstract public void savedMore();
          524:         abstract public boolean isCanceled();
          525:     }
          526:     static public long saveStreamToFile(InputStream stream, File file, SavingUpdate update) throws IOException {
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          524:         abstract public boolean isCanceled();
          525:     }
          526:     static public long saveStreamToFile(InputStream stream, File file, SavingUpdate update) throws IOException {
          527:         long length &#x3D; 0;
          528:         FileOutputStream fos &#x3D; new FileOutputStream(file);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          524:         abstract public boolean isCanceled();
          525:     }
          526:     static public long saveStreamToFile(InputStream stream, File file, SavingUpdate update) throws IOException {
          527:         long length &#x3D; 0;
          528:         FileOutputStream fos &#x3D; new FileOutputStream(file);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/PT
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--high">
                      <span class="label__text">high severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Path Traversal</p>
                          <!--Rule ID: java/PT</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-23</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/ImportingUtilities.java (line : 380)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          376:                     progress.setProgress(
          377:                         &quot;Saving file &quot; + fileName + &quot; locally (&quot; + formatBytes(fileSize) + &quot; bytes)&quot;,
          378:                         calculateProgressPercent(update.totalExpectedSize, update.totalRetrievedSize));
          379:                     
          380:                     JSONUtilities.safePut(fileRecord, &quot;size&quot;, saveStreamToFile(stream, file, null));
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Unsanitized input from a zip file flows into java.io.FileOutputStream, where it is used as a path. This may result in a Path Traversal vulnerability and allow an attacker to write to arbitrary files.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          670:             try {
          671:                 ZipEntry ze;
          672:                 while (!progress.isCanceled() &amp;&amp; (ze &#x3D; zis.getNextEntry()) !&#x3D; null) {
          673:                     if (!ze.isDirectory()) {
          674:                         String fileName2 &#x3D; ze.getName();
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          670:             try {
          671:                 ZipEntry ze;
          672:                 while (!progress.isCanceled() &amp;&amp; (ze &#x3D; zis.getNextEntry()) !&#x3D; null) {
          673:                     if (!ze.isDirectory()) {
          674:                         String fileName2 &#x3D; ze.getName();
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          670:             try {
          671:                 ZipEntry ze;
          672:                 while (!progress.isCanceled() &amp;&amp; (ze &#x3D; zis.getNextEntry()) !&#x3D; null) {
          673:                     if (!ze.isDirectory()) {
          674:                         String fileName2 &#x3D; ze.getName();
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          671:                 ZipEntry ze;
          672:                 while (!progress.isCanceled() &amp;&amp; (ze &#x3D; zis.getNextEntry()) !&#x3D; null) {
          673:                     if (!ze.isDirectory()) {
          674:                         String fileName2 &#x3D; ze.getName();
          675:                         File file2 &#x3D; allocateFile(rawDataDir, fileName2);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          436:         String location &#x3D; file.getAbsolutePath().substring(dir.getAbsolutePath().length());
          437:         return (location.startsWith(File.separator)) ? location.substring(1) : location;
          438:     }
          439:     
          440:     static public File allocateFile(File dir, String name) {
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          437:         return (location.startsWith(File.separator)) ? location.substring(1) : location;
          438:     }
          439:     
          440:     static public File allocateFile(File dir, String name) {
          441:         int q &#x3D; name.indexOf(&#x27;?&#x27;);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          439:     
          440:     static public File allocateFile(File dir, String name) {
          441:         int q &#x3D; name.indexOf(&#x27;?&#x27;);
          442:         if (q &gt; 0) {
          443:             name &#x3D; name.substring(0, q);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          448:         if (!file.toPath().normalize().startsWith(dir.toPath().normalize() + File.separator)) {
          449:             throw new IllegalArgumentException(&quot;Zip archives with files escaping their root directory are not allowed.&quot;);
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          449:             throw new IllegalArgumentException(&quot;Zip archives with files escaping their root directory are not allowed.&quot;);
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          449:             throw new IllegalArgumentException(&quot;Zip archives with files escaping their root directory are not allowed.&quot;);
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          449:             throw new IllegalArgumentException(&quot;Zip archives with files escaping their root directory are not allowed.&quot;);
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          455:         int index &#x3D; 2;
          456:         while (file.exists()) {
          457:             file &#x3D; new File(dir, prefix + &quot;-&quot; + index++ + suffix);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          455:         int index &#x3D; 2;
          456:         while (file.exists()) {
          457:             file &#x3D; new File(dir, prefix + &quot;-&quot; + index++ + suffix);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          455:         int index &#x3D; 2;
          456:         while (file.exists()) {
          457:             file &#x3D; new File(dir, prefix + &quot;-&quot; + index++ + suffix);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          455:         int index &#x3D; 2;
          456:         while (file.exists()) {
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          456:         while (file.exists()) {
          457:             file &#x3D; new File(dir, prefix + &quot;-&quot; + index++ + suffix);
          458:         }
          459:         
          460:         file.getParentFile().mkdirs();
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          458:         }
          459:         
          460:         file.getParentFile().mkdirs();
          461:         
          462:         return file;
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          671:                 ZipEntry ze;
          672:                 while (!progress.isCanceled() &amp;&amp; (ze &#x3D; zis.getNextEntry()) !&#x3D; null) {
          673:                     if (!ze.isDirectory()) {
          674:                         String fileName2 &#x3D; ze.getName();
          675:                         File file2 &#x3D; allocateFile(rawDataDir, fileName2);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          681:                         JSONUtilities.safePut(fileRecord2, &quot;declaredEncoding&quot;, (String) null);
          682:                         JSONUtilities.safePut(fileRecord2, &quot;declaredMimeType&quot;, (String) null);
          683:                         JSONUtilities.safePut(fileRecord2, &quot;fileName&quot;, fileName2);
          684:                         JSONUtilities.safePut(fileRecord2, &quot;archiveFileName&quot;, JSONUtilities.getString(archiveFileRecord, &quot;fileName&quot;, null));
          685:                         JSONUtilities.safePut(fileRecord2, &quot;location&quot;, getRelativePath(file2, rawDataDir));
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          431:             calculateProgressPercent(update.totalExpectedSize, update.totalRetrievedSize));
          432:         return postProcessRetrievedFile(rawDataDir, file, fileRecord, fileRecords, progress);
          433:     }
          434:     
          435:     static public String getRelativePath(File file, File dir) {
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          432:         return postProcessRetrievedFile(rawDataDir, file, fileRecord, fileRecords, progress);
          433:     }
          434:     
          435:     static public String getRelativePath(File file, File dir) {
          436:         String location &#x3D; file.getAbsolutePath().substring(dir.getAbsolutePath().length());
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          376:                     progress.setProgress(
          377:                         &quot;Saving file &quot; + fileName + &quot; locally (&quot; + formatBytes(fileSize) + &quot; bytes)&quot;,
          378:                         calculateProgressPercent(update.totalExpectedSize, update.totalRetrievedSize));
          379:                     
          380:                     JSONUtilities.safePut(fileRecord, &quot;size&quot;, saveStreamToFile(stream, file, null));
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          376:                     progress.setProgress(
          377:                         &quot;Saving file &quot; + fileName + &quot; locally (&quot; + formatBytes(fileSize) + &quot; bytes)&quot;,
          378:                         calculateProgressPercent(update.totalExpectedSize, update.totalRetrievedSize));
          379:                     
          380:                     JSONUtilities.safePut(fileRecord, &quot;size&quot;, saveStreamToFile(stream, file, null));
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          522:         
          523:         abstract public void savedMore();
          524:         abstract public boolean isCanceled();
          525:     }
          526:     static public long saveStreamToFile(InputStream stream, File file, SavingUpdate update) throws IOException {
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          524:         abstract public boolean isCanceled();
          525:     }
          526:     static public long saveStreamToFile(InputStream stream, File file, SavingUpdate update) throws IOException {
          527:         long length &#x3D; 0;
          528:         FileOutputStream fos &#x3D; new FileOutputStream(file);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          524:         abstract public boolean isCanceled();
          525:     }
          526:     static public long saveStreamToFile(InputStream stream, File file, SavingUpdate update) throws IOException {
          527:         long length &#x3D; 0;
          528:         FileOutputStream fos &#x3D; new FileOutputStream(file);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/PT
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--high">
                      <span class="label__text">high severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Path Traversal</p>
                          <!--Rule ID: java/PT</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-23</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/ImportingUtilities.java (line : 528)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          524:         abstract public boolean isCanceled();
          525:     }
          526:     static public long saveStreamToFile(InputStream stream, File file, SavingUpdate update) throws IOException {
          527:         long length &#x3D; 0;
          528:         FileOutputStream fos &#x3D; new FileOutputStream(file);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Unsanitized input from a zip file flows into java.io.FileOutputStream, where it is used as a path. This may result in a Path Traversal vulnerability and allow an attacker to write to arbitrary files.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          670:             try {
          671:                 ZipEntry ze;
          672:                 while (!progress.isCanceled() &amp;&amp; (ze &#x3D; zis.getNextEntry()) !&#x3D; null) {
          673:                     if (!ze.isDirectory()) {
          674:                         String fileName2 &#x3D; ze.getName();
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          670:             try {
          671:                 ZipEntry ze;
          672:                 while (!progress.isCanceled() &amp;&amp; (ze &#x3D; zis.getNextEntry()) !&#x3D; null) {
          673:                     if (!ze.isDirectory()) {
          674:                         String fileName2 &#x3D; ze.getName();
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          670:             try {
          671:                 ZipEntry ze;
          672:                 while (!progress.isCanceled() &amp;&amp; (ze &#x3D; zis.getNextEntry()) !&#x3D; null) {
          673:                     if (!ze.isDirectory()) {
          674:                         String fileName2 &#x3D; ze.getName();
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          671:                 ZipEntry ze;
          672:                 while (!progress.isCanceled() &amp;&amp; (ze &#x3D; zis.getNextEntry()) !&#x3D; null) {
          673:                     if (!ze.isDirectory()) {
          674:                         String fileName2 &#x3D; ze.getName();
          675:                         File file2 &#x3D; allocateFile(rawDataDir, fileName2);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          436:         String location &#x3D; file.getAbsolutePath().substring(dir.getAbsolutePath().length());
          437:         return (location.startsWith(File.separator)) ? location.substring(1) : location;
          438:     }
          439:     
          440:     static public File allocateFile(File dir, String name) {
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          437:         return (location.startsWith(File.separator)) ? location.substring(1) : location;
          438:     }
          439:     
          440:     static public File allocateFile(File dir, String name) {
          441:         int q &#x3D; name.indexOf(&#x27;?&#x27;);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          439:     
          440:     static public File allocateFile(File dir, String name) {
          441:         int q &#x3D; name.indexOf(&#x27;?&#x27;);
          442:         if (q &gt; 0) {
          443:             name &#x3D; name.substring(0, q);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          448:         if (!file.toPath().normalize().startsWith(dir.toPath().normalize() + File.separator)) {
          449:             throw new IllegalArgumentException(&quot;Zip archives with files escaping their root directory are not allowed.&quot;);
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          449:             throw new IllegalArgumentException(&quot;Zip archives with files escaping their root directory are not allowed.&quot;);
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          449:             throw new IllegalArgumentException(&quot;Zip archives with files escaping their root directory are not allowed.&quot;);
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          449:             throw new IllegalArgumentException(&quot;Zip archives with files escaping their root directory are not allowed.&quot;);
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          450:         }
          451:         
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          455:         int index &#x3D; 2;
          456:         while (file.exists()) {
          457:             file &#x3D; new File(dir, prefix + &quot;-&quot; + index++ + suffix);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          455:         int index &#x3D; 2;
          456:         while (file.exists()) {
          457:             file &#x3D; new File(dir, prefix + &quot;-&quot; + index++ + suffix);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          455:         int index &#x3D; 2;
          456:         while (file.exists()) {
          457:             file &#x3D; new File(dir, prefix + &quot;-&quot; + index++ + suffix);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          452:         int dot &#x3D; name.lastIndexOf(&#x27;.&#x27;);
          453:         String prefix &#x3D; dot &lt; 0 ? name : name.substring(0, dot);
          454:         String suffix &#x3D; dot &lt; 0 ? &quot;&quot; : name.substring(dot);
          455:         int index &#x3D; 2;
          456:         while (file.exists()) {
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          456:         while (file.exists()) {
          457:             file &#x3D; new File(dir, prefix + &quot;-&quot; + index++ + suffix);
          458:         }
          459:         
          460:         file.getParentFile().mkdirs();
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          458:         }
          459:         
          460:         file.getParentFile().mkdirs();
          461:         
          462:         return file;
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          739:                 fileName &#x3D; fileName.substring(0, fileName.length()-ext.length());
          740:                 break;
          741:             }
          742:         }
          743:         File file2 &#x3D; allocateFile(rawDataDir, fileName);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          743:         File file2 &#x3D; allocateFile(rawDataDir, fileName);
          744:         
          745:         progress.setProgress(&quot;Uncompressing &quot; + fileName, -1);
          746:         
          747:         saveStreamToFile(uncompressedIS, file2, null);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          522:         
          523:         abstract public void savedMore();
          524:         abstract public boolean isCanceled();
          525:     }
          526:     static public long saveStreamToFile(InputStream stream, File file, SavingUpdate update) throws IOException {
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          524:         abstract public boolean isCanceled();
          525:     }
          526:     static public long saveStreamToFile(InputStream stream, File file, SavingUpdate update) throws IOException {
          527:         long length &#x3D; 0;
          528:         FileOutputStream fos &#x3D; new FileOutputStream(file);
          </code></pre>
                              <div>File location: test-code-src/ImportingUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          524:         abstract public boolean isCanceled();
          525:     }
          526:     static public long saveStreamToFile(InputStream stream, File file, SavingUpdate update) throws IOException {
          527:         long length &#x3D; 0;
          528:         FileOutputStream fos &#x3D; new FileOutputStream(file);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/PT
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--high">
                      <span class="label__text">high severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Path Traversal</p>
                          <!--Rule ID: java/PT</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-23</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/FileProjectManager.java (line : 177)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          173: 
          174:             if (tarEntry.isDirectory()) {
          175:                 destEntry.mkdirs();
          176:             } else {
          177:                 FileOutputStream fout &#x3D; new FileOutputStream(destEntry);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Unsanitized input from a zip file flows into java.io.FileOutputStream, where it is used as a path. This may result in a Path Traversal vulnerability and allow an attacker to write to arbitrary files.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/FileProjectManager.java</div>
                              <div>Code:</div>
                              <pre><code>
          163:         TarArchiveInputStream tin &#x3D; new TarArchiveInputStream(inputStream);
          164:         TarArchiveEntry tarEntry &#x3D; null;
          165: 
          166:         while ((tarEntry &#x3D; tin.getNextTarEntry()) !&#x3D; null) {
          167:             File destEntry &#x3D; new File(destDir, tarEntry.getName());
          </code></pre>
                              <div>File location: test-code-src/FileProjectManager.java</div>
                              <div>Code:</div>
                              <pre><code>
          163:         TarArchiveInputStream tin &#x3D; new TarArchiveInputStream(inputStream);
          164:         TarArchiveEntry tarEntry &#x3D; null;
          165: 
          166:         while ((tarEntry &#x3D; tin.getNextTarEntry()) !&#x3D; null) {
          167:             File destEntry &#x3D; new File(destDir, tarEntry.getName());
          </code></pre>
                              <div>File location: test-code-src/FileProjectManager.java</div>
                              <div>Code:</div>
                              <pre><code>
          163:         TarArchiveInputStream tin &#x3D; new TarArchiveInputStream(inputStream);
          164:         TarArchiveEntry tarEntry &#x3D; null;
          165: 
          166:         while ((tarEntry &#x3D; tin.getNextTarEntry()) !&#x3D; null) {
          167:             File destEntry &#x3D; new File(destDir, tarEntry.getName());
          </code></pre>
                              <div>File location: test-code-src/FileProjectManager.java</div>
                              <div>Code:</div>
                              <pre><code>
          163:         TarArchiveInputStream tin &#x3D; new TarArchiveInputStream(inputStream);
          164:         TarArchiveEntry tarEntry &#x3D; null;
          165: 
          166:         while ((tarEntry &#x3D; tin.getNextTarEntry()) !&#x3D; null) {
          167:             File destEntry &#x3D; new File(destDir, tarEntry.getName());
          </code></pre>
                              <div>File location: test-code-src/FileProjectManager.java</div>
                              <div>Code:</div>
                              <pre><code>
          164:         TarArchiveEntry tarEntry &#x3D; null;
          165: 
          166:         while ((tarEntry &#x3D; tin.getNextTarEntry()) !&#x3D; null) {
          167:             File destEntry &#x3D; new File(destDir, tarEntry.getName());
          168:             File parent &#x3D; destEntry.getParentFile();
          </code></pre>
                              <div>File location: test-code-src/FileProjectManager.java</div>
                              <div>Code:</div>
                              <pre><code>
          173: 
          174:             if (tarEntry.isDirectory()) {
          175:                 destEntry.mkdirs();
          176:             } else {
          177:                 FileOutputStream fout &#x3D; new FileOutputStream(destEntry);
          </code></pre>
                              <div>File location: test-code-src/FileProjectManager.java</div>
                              <div>Code:</div>
                              <pre><code>
          173: 
          174:             if (tarEntry.isDirectory()) {
          175:                 destEntry.mkdirs();
          176:             } else {
          177:                 FileOutputStream fout &#x3D; new FileOutputStream(destEntry);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/PT
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--high">
                      <span class="label__text">high severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Path Traversal</p>
                          <!--Rule ID: java/PT</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-23</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/UploadCommand.java (line : 161)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          157:         try {
          158:             java.io.File filePath &#x3D; java.io.File.createTempFile(name, &quot;.tgz&quot;); 
          159:             filePath.deleteOnExit();
          160:             
          161:             fos &#x3D; new FileOutputStream(filePath);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Unsanitized input from an HTTP parameter flows into java.io.FileOutputStream, where it is used as a path. This may result in a Path Traversal vulnerability and allow an attacker to write to arbitrary files.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          69:     @SuppressWarnings(&quot;unchecked&quot;)
          70:     static public Properties getRequestParameters(HttpServletRequest request) {
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          69:     @SuppressWarnings(&quot;unchecked&quot;)
          70:     static public Properties getRequestParameters(HttpServletRequest request) {
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          69:     @SuppressWarnings(&quot;unchecked&quot;)
          70:     static public Properties getRequestParameters(HttpServletRequest request) {
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          70:     static public Properties getRequestParameters(HttpServletRequest request) {
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          74:         while (en.hasMoreElements()) {
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          74:         while (en.hasMoreElements()) {
          75:             String name &#x3D; en.nextElement();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          74:         while (en.hasMoreElements()) {
          75:             String name &#x3D; en.nextElement();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          74:         while (en.hasMoreElements()) {
          75:             String name &#x3D; en.nextElement();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          74:         while (en.hasMoreElements()) {
          75:             String name &#x3D; en.nextElement();
          76:             options.put(name, request.getParameter(name));
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          74:         while (en.hasMoreElements()) {
          75:             String name &#x3D; en.nextElement();
          76:             options.put(name, request.getParameter(name));
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          74:         while (en.hasMoreElements()) {
          75:             String name &#x3D; en.nextElement();
          76:             options.put(name, request.getParameter(name));
          77:         }
          78:         return options;
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          87:         ProjectManager.singleton.setBusy(true);
          88:         try {
          89:             Project project &#x3D; getProject(request);
          90:             Engine engine &#x3D; getEngine(request, project);
          91:             Properties params &#x3D; ExportRowsCommand.getRequestParameters(request);
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          87:         ProjectManager.singleton.setBusy(true);
          88:         try {
          89:             Project project &#x3D; getProject(request);
          90:             Engine engine &#x3D; getEngine(request, project);
          91:             Properties params &#x3D; ExportRowsCommand.getRequestParameters(request);
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          88:         try {
          89:             Project project &#x3D; getProject(request);
          90:             Engine engine &#x3D; getEngine(request, project);
          91:             Properties params &#x3D; ExportRowsCommand.getRequestParameters(request);
          92:             String name &#x3D; params.getProperty(&quot;name&quot;);
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          88:         try {
          89:             Project project &#x3D; getProject(request);
          90:             Engine engine &#x3D; getEngine(request, project);
          91:             Properties params &#x3D; ExportRowsCommand.getRequestParameters(request);
          92:             String name &#x3D; params.getProperty(&quot;name&quot;);
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          88:         try {
          89:             Project project &#x3D; getProject(request);
          90:             Engine engine &#x3D; getEngine(request, project);
          91:             Properties params &#x3D; ExportRowsCommand.getRequestParameters(request);
          92:             String name &#x3D; params.getProperty(&quot;name&quot;);
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          99:             try {
          100:                 writer.writeStartObject();
          101:                 
          102:                 List&lt;Exception&gt; exceptions &#x3D; new LinkedList&lt;Exception&gt;();
          103:                 String url &#x3D; upload(project, engine, params, token, name, exceptions);
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          134:     }
          135: 
          136:     private String upload(
          137:             Project project, Engine engine, Properties params,
          138:             String token, String name, List&lt;Exception&gt; exceptions) {
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          139:         String format &#x3D; params.getProperty(&quot;format&quot;);
          140:         if (&quot;gdata/google-spreadsheet&quot;.equals(format)) {
          141:             return uploadSpreadsheet(project, engine, params, token, name, exceptions);
          142:         } else if ((&quot;raw/openrefine-project&quot;).equals(format)) {
          143:             return uploadOpenRefineProject(project, token, name, exceptions);
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          150:         return IOUtils.toByteArray(is);
          151:     }
          152: 
          153:     private String uploadOpenRefineProject(Project project, String token,
          154:             String name, List&lt;Exception&gt; exceptions) {
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          154:             String name, List&lt;Exception&gt; exceptions) {
          155:         FileOutputStream fos &#x3D; null;
          156:         
          157:         try {
          158:             java.io.File filePath &#x3D; java.io.File.createTempFile(name, &quot;.tgz&quot;); 
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          154:             String name, List&lt;Exception&gt; exceptions) {
          155:         FileOutputStream fos &#x3D; null;
          156:         
          157:         try {
          158:             java.io.File filePath &#x3D; java.io.File.createTempFile(name, &quot;.tgz&quot;); 
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          155:         FileOutputStream fos &#x3D; null;
          156:         
          157:         try {
          158:             java.io.File filePath &#x3D; java.io.File.createTempFile(name, &quot;.tgz&quot;); 
          159:             filePath.deleteOnExit();
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          157:         try {
          158:             java.io.File filePath &#x3D; java.io.File.createTempFile(name, &quot;.tgz&quot;); 
          159:             filePath.deleteOnExit();
          160:             
          161:             fos &#x3D; new FileOutputStream(filePath);
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          157:         try {
          158:             java.io.File filePath &#x3D; java.io.File.createTempFile(name, &quot;.tgz&quot;); 
          159:             filePath.deleteOnExit();
          160:             
          161:             fos &#x3D; new FileOutputStream(filePath);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/PT
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--high">
                      <span class="label__text">high severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Path Traversal</p>
                          <!--Rule ID: java/PT</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-23</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/UploadCommand.java (line : 162)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          158:             java.io.File filePath &#x3D; java.io.File.createTempFile(name, &quot;.tgz&quot;); 
          159:             filePath.deleteOnExit();
          160:             
          161:             fos &#x3D; new FileOutputStream(filePath);
          162:             FileProjectManager.gzipTarToOutputStream(project, fos);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Unsanitized input from an HTTP parameter flows into java.util.zip.GZIPOutputStream, where it is used as a path. This may result in a Path Traversal vulnerability and allow an attacker to write to arbitrary files.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          69:     @SuppressWarnings(&quot;unchecked&quot;)
          70:     static public Properties getRequestParameters(HttpServletRequest request) {
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          69:     @SuppressWarnings(&quot;unchecked&quot;)
          70:     static public Properties getRequestParameters(HttpServletRequest request) {
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          69:     @SuppressWarnings(&quot;unchecked&quot;)
          70:     static public Properties getRequestParameters(HttpServletRequest request) {
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          70:     static public Properties getRequestParameters(HttpServletRequest request) {
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          74:         while (en.hasMoreElements()) {
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          74:         while (en.hasMoreElements()) {
          75:             String name &#x3D; en.nextElement();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          74:         while (en.hasMoreElements()) {
          75:             String name &#x3D; en.nextElement();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          74:         while (en.hasMoreElements()) {
          75:             String name &#x3D; en.nextElement();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          74:         while (en.hasMoreElements()) {
          75:             String name &#x3D; en.nextElement();
          76:             options.put(name, request.getParameter(name));
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          74:         while (en.hasMoreElements()) {
          75:             String name &#x3D; en.nextElement();
          76:             options.put(name, request.getParameter(name));
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          74:         while (en.hasMoreElements()) {
          75:             String name &#x3D; en.nextElement();
          76:             options.put(name, request.getParameter(name));
          77:         }
          78:         return options;
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          87:         ProjectManager.singleton.setBusy(true);
          88:         try {
          89:             Project project &#x3D; getProject(request);
          90:             Engine engine &#x3D; getEngine(request, project);
          91:             Properties params &#x3D; ExportRowsCommand.getRequestParameters(request);
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          87:         ProjectManager.singleton.setBusy(true);
          88:         try {
          89:             Project project &#x3D; getProject(request);
          90:             Engine engine &#x3D; getEngine(request, project);
          91:             Properties params &#x3D; ExportRowsCommand.getRequestParameters(request);
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          88:         try {
          89:             Project project &#x3D; getProject(request);
          90:             Engine engine &#x3D; getEngine(request, project);
          91:             Properties params &#x3D; ExportRowsCommand.getRequestParameters(request);
          92:             String name &#x3D; params.getProperty(&quot;name&quot;);
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          88:         try {
          89:             Project project &#x3D; getProject(request);
          90:             Engine engine &#x3D; getEngine(request, project);
          91:             Properties params &#x3D; ExportRowsCommand.getRequestParameters(request);
          92:             String name &#x3D; params.getProperty(&quot;name&quot;);
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          88:         try {
          89:             Project project &#x3D; getProject(request);
          90:             Engine engine &#x3D; getEngine(request, project);
          91:             Properties params &#x3D; ExportRowsCommand.getRequestParameters(request);
          92:             String name &#x3D; params.getProperty(&quot;name&quot;);
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          99:             try {
          100:                 writer.writeStartObject();
          101:                 
          102:                 List&lt;Exception&gt; exceptions &#x3D; new LinkedList&lt;Exception&gt;();
          103:                 String url &#x3D; upload(project, engine, params, token, name, exceptions);
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          134:     }
          135: 
          136:     private String upload(
          137:             Project project, Engine engine, Properties params,
          138:             String token, String name, List&lt;Exception&gt; exceptions) {
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          139:         String format &#x3D; params.getProperty(&quot;format&quot;);
          140:         if (&quot;gdata/google-spreadsheet&quot;.equals(format)) {
          141:             return uploadSpreadsheet(project, engine, params, token, name, exceptions);
          142:         } else if ((&quot;raw/openrefine-project&quot;).equals(format)) {
          143:             return uploadOpenRefineProject(project, token, name, exceptions);
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          150:         return IOUtils.toByteArray(is);
          151:     }
          152: 
          153:     private String uploadOpenRefineProject(Project project, String token,
          154:             String name, List&lt;Exception&gt; exceptions) {
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          154:             String name, List&lt;Exception&gt; exceptions) {
          155:         FileOutputStream fos &#x3D; null;
          156:         
          157:         try {
          158:             java.io.File filePath &#x3D; java.io.File.createTempFile(name, &quot;.tgz&quot;); 
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          154:             String name, List&lt;Exception&gt; exceptions) {
          155:         FileOutputStream fos &#x3D; null;
          156:         
          157:         try {
          158:             java.io.File filePath &#x3D; java.io.File.createTempFile(name, &quot;.tgz&quot;); 
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          155:         FileOutputStream fos &#x3D; null;
          156:         
          157:         try {
          158:             java.io.File filePath &#x3D; java.io.File.createTempFile(name, &quot;.tgz&quot;); 
          159:             filePath.deleteOnExit();
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          157:         try {
          158:             java.io.File filePath &#x3D; java.io.File.createTempFile(name, &quot;.tgz&quot;); 
          159:             filePath.deleteOnExit();
          160:             
          161:             fos &#x3D; new FileOutputStream(filePath);
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          157:         try {
          158:             java.io.File filePath &#x3D; java.io.File.createTempFile(name, &quot;.tgz&quot;); 
          159:             filePath.deleteOnExit();
          160:             
          161:             fos &#x3D; new FileOutputStream(filePath);
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          158:             java.io.File filePath &#x3D; java.io.File.createTempFile(name, &quot;.tgz&quot;); 
          159:             filePath.deleteOnExit();
          160:             
          161:             fos &#x3D; new FileOutputStream(filePath);
          162:             FileProjectManager.gzipTarToOutputStream(project, fos);
          </code></pre>
                              <div>File location: test-code-src/UploadCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          158:             java.io.File filePath &#x3D; java.io.File.createTempFile(name, &quot;.tgz&quot;); 
          159:             filePath.deleteOnExit();
          160:             
          161:             fos &#x3D; new FileOutputStream(filePath);
          162:             FileProjectManager.gzipTarToOutputStream(project, fos);
          </code></pre>
                              <div>File location: test-code-src/FileProjectManager.java</div>
                              <div>Code:</div>
                              <pre><code>
          422:     public HistoryEntryManager getHistoryEntryManager(){
          423:         return new FileHistoryEntryManager();
          424:     }
          425:     
          426:     public static void gzipTarToOutputStream(Project project, OutputStream os) throws IOException {
          </code></pre>
                              <div>File location: test-code-src/FileProjectManager.java</div>
                              <div>Code:</div>
                              <pre><code>
          423:         return new FileHistoryEntryManager();
          424:     }
          425:     
          426:     public static void gzipTarToOutputStream(Project project, OutputStream os) throws IOException {
          427:         GZIPOutputStream gos &#x3D; new GZIPOutputStream(os);
          </code></pre>
                              <div>File location: test-code-src/FileProjectManager.java</div>
                              <div>Code:</div>
                              <pre><code>
          423:         return new FileHistoryEntryManager();
          424:     }
          425:     
          426:     public static void gzipTarToOutputStream(Project project, OutputStream os) throws IOException {
          427:         GZIPOutputStream gos &#x3D; new GZIPOutputStream(os);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/PT
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--high">
                      <span class="label__text">high severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Path Traversal</p>
                          <!--Rule ID: java/PT</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-23</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/LoadLanguageCommand.java (line : 101)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          97:         ObjectNode translations &#x3D; null;
          98:         String bestLang &#x3D; null;
          99:         for (int i &#x3D; langs.length-1; i &gt;&#x3D; 0; i--) {
          100:             if (langs[i] &#x3D;&#x3D; null) continue;
          101:             ObjectNode json &#x3D; loadLanguage(this.servlet, modname, langs[i]);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Unsanitized input from an HTTP parameter flows into java.io.FileInputStream, where it is used as a path. This may result in a Path Traversal vulnerability and allow an attacker to read arbitrary files.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          79:         if (modname &#x3D;&#x3D; null) {
          80:             modname &#x3D; &quot;core&quot;;
          81:         }
          82: 
          83:         String[] langs &#x3D; request.getParameterValues(&quot;lang&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          79:         if (modname &#x3D;&#x3D; null) {
          80:             modname &#x3D; &quot;core&quot;;
          81:         }
          82: 
          83:         String[] langs &#x3D; request.getParameterValues(&quot;lang&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          79:         if (modname &#x3D;&#x3D; null) {
          80:             modname &#x3D; &quot;core&quot;;
          81:         }
          82: 
          83:         String[] langs &#x3D; request.getParameterValues(&quot;lang&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          80:             modname &#x3D; &quot;core&quot;;
          81:         }
          82: 
          83:         String[] langs &#x3D; request.getParameterValues(&quot;lang&quot;);
          84:         if (langs &#x3D;&#x3D; null || &quot;&quot;.equals(langs[0])) {
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          88:             }
          89:         }
          90:         
          91:         // Default language is English
          92:         if (langs.length &#x3D;&#x3D; 0 || langs[langs.length-1] !&#x3D; &quot;en&quot; ) {
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          88:             }
          89:         }
          90:         
          91:         // Default language is English
          92:         if (langs.length &#x3D;&#x3D; 0 || langs[langs.length-1] !&#x3D; &quot;en&quot; ) {
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          88:             }
          89:         }
          90:         
          91:         // Default language is English
          92:         if (langs.length &#x3D;&#x3D; 0 || langs[langs.length-1] !&#x3D; &quot;en&quot; ) {
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          89:         }
          90:         
          91:         // Default language is English
          92:         if (langs.length &#x3D;&#x3D; 0 || langs[langs.length-1] !&#x3D; &quot;en&quot; ) {
          93:             langs &#x3D; Arrays.copyOf(langs, langs.length+1);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          95:         }
          96: 
          97:         ObjectNode translations &#x3D; null;
          98:         String bestLang &#x3D; null;
          99:         for (int i &#x3D; langs.length-1; i &gt;&#x3D; 0; i--) {
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          96: 
          97:         ObjectNode translations &#x3D; null;
          98:         String bestLang &#x3D; null;
          99:         for (int i &#x3D; langs.length-1; i &gt;&#x3D; 0; i--) {
          100:             if (langs[i] &#x3D;&#x3D; null) continue;
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          97:         ObjectNode translations &#x3D; null;
          98:         String bestLang &#x3D; null;
          99:         for (int i &#x3D; langs.length-1; i &gt;&#x3D; 0; i--) {
          100:             if (langs[i] &#x3D;&#x3D; null) continue;
          101:             ObjectNode json &#x3D; loadLanguage(this.servlet, modname, langs[i]);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          97:         ObjectNode translations &#x3D; null;
          98:         String bestLang &#x3D; null;
          99:         for (int i &#x3D; langs.length-1; i &gt;&#x3D; 0; i--) {
          100:             if (langs[i] &#x3D;&#x3D; null) continue;
          101:             ObjectNode json &#x3D; loadLanguage(this.servlet, modname, langs[i]);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          97:         ObjectNode translations &#x3D; null;
          98:         String bestLang &#x3D; null;
          99:         for (int i &#x3D; langs.length-1; i &gt;&#x3D; 0; i--) {
          100:             if (langs[i] &#x3D;&#x3D; null) continue;
          101:             ObjectNode json &#x3D; loadLanguage(this.servlet, modname, langs[i]);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          122:         	logger.error(&quot;Failed to load any language files&quot;);
          123:         }
          124:     }
          125:     
          126:     static ObjectNode loadLanguage(RefineServlet servlet, String modname, String lang) throws UnsupportedEncodingException {
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          125:     
          126:     static ObjectNode loadLanguage(RefineServlet servlet, String modname, String lang) throws UnsupportedEncodingException {
          127:         
          128:         ButterflyModule module &#x3D; servlet.getModule(modname);
          129:         File langFile &#x3D; new File(module.getPath(), &quot;langs&quot; + File.separator + &quot;translation-&quot; + lang + &quot;.json&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          125:     
          126:     static ObjectNode loadLanguage(RefineServlet servlet, String modname, String lang) throws UnsupportedEncodingException {
          127:         
          128:         ButterflyModule module &#x3D; servlet.getModule(modname);
          129:         File langFile &#x3D; new File(module.getPath(), &quot;langs&quot; + File.separator + &quot;translation-&quot; + lang + &quot;.json&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          125:     
          126:     static ObjectNode loadLanguage(RefineServlet servlet, String modname, String lang) throws UnsupportedEncodingException {
          127:         
          128:         ButterflyModule module &#x3D; servlet.getModule(modname);
          129:         File langFile &#x3D; new File(module.getPath(), &quot;langs&quot; + File.separator + &quot;translation-&quot; + lang + &quot;.json&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          125:     
          126:     static ObjectNode loadLanguage(RefineServlet servlet, String modname, String lang) throws UnsupportedEncodingException {
          127:         
          128:         ButterflyModule module &#x3D; servlet.getModule(modname);
          129:         File langFile &#x3D; new File(module.getPath(), &quot;langs&quot; + File.separator + &quot;translation-&quot; + lang + &quot;.json&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          127:         
          128:         ButterflyModule module &#x3D; servlet.getModule(modname);
          129:         File langFile &#x3D; new File(module.getPath(), &quot;langs&quot; + File.separator + &quot;translation-&quot; + lang + &quot;.json&quot;);
          130:         try {
          131:             Reader reader &#x3D; new BufferedReader(new InputStreamReader(new FileInputStream(langFile), &quot;UTF-8&quot;));
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          127:         
          128:         ButterflyModule module &#x3D; servlet.getModule(modname);
          129:         File langFile &#x3D; new File(module.getPath(), &quot;langs&quot; + File.separator + &quot;translation-&quot; + lang + &quot;.json&quot;);
          130:         try {
          131:             Reader reader &#x3D; new BufferedReader(new InputStreamReader(new FileInputStream(langFile), &quot;UTF-8&quot;));
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/PT
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--high">
                      <span class="label__text">high severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Path Traversal</p>
                          <!--Rule ID: java/PT</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-23</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/LoadLanguageCommand.java (line : 131)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          127:         
          128:         ButterflyModule module &#x3D; servlet.getModule(modname);
          129:         File langFile &#x3D; new File(module.getPath(), &quot;langs&quot; + File.separator + &quot;translation-&quot; + lang + &quot;.json&quot;);
          130:         try {
          131:             Reader reader &#x3D; new BufferedReader(new InputStreamReader(new FileInputStream(langFile), &quot;UTF-8&quot;));
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Unsanitized input from an HTTP parameter flows into java.io.FileInputStream, where it is used as a path. This may result in a Path Traversal vulnerability and allow an attacker to read arbitrary files.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          79:         if (modname &#x3D;&#x3D; null) {
          80:             modname &#x3D; &quot;core&quot;;
          81:         }
          82: 
          83:         String[] langs &#x3D; request.getParameterValues(&quot;lang&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          79:         if (modname &#x3D;&#x3D; null) {
          80:             modname &#x3D; &quot;core&quot;;
          81:         }
          82: 
          83:         String[] langs &#x3D; request.getParameterValues(&quot;lang&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          79:         if (modname &#x3D;&#x3D; null) {
          80:             modname &#x3D; &quot;core&quot;;
          81:         }
          82: 
          83:         String[] langs &#x3D; request.getParameterValues(&quot;lang&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          80:             modname &#x3D; &quot;core&quot;;
          81:         }
          82: 
          83:         String[] langs &#x3D; request.getParameterValues(&quot;lang&quot;);
          84:         if (langs &#x3D;&#x3D; null || &quot;&quot;.equals(langs[0])) {
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          88:             }
          89:         }
          90:         
          91:         // Default language is English
          92:         if (langs.length &#x3D;&#x3D; 0 || langs[langs.length-1] !&#x3D; &quot;en&quot; ) {
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          88:             }
          89:         }
          90:         
          91:         // Default language is English
          92:         if (langs.length &#x3D;&#x3D; 0 || langs[langs.length-1] !&#x3D; &quot;en&quot; ) {
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          88:             }
          89:         }
          90:         
          91:         // Default language is English
          92:         if (langs.length &#x3D;&#x3D; 0 || langs[langs.length-1] !&#x3D; &quot;en&quot; ) {
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          89:         }
          90:         
          91:         // Default language is English
          92:         if (langs.length &#x3D;&#x3D; 0 || langs[langs.length-1] !&#x3D; &quot;en&quot; ) {
          93:             langs &#x3D; Arrays.copyOf(langs, langs.length+1);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          95:         }
          96: 
          97:         ObjectNode translations &#x3D; null;
          98:         String bestLang &#x3D; null;
          99:         for (int i &#x3D; langs.length-1; i &gt;&#x3D; 0; i--) {
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          96: 
          97:         ObjectNode translations &#x3D; null;
          98:         String bestLang &#x3D; null;
          99:         for (int i &#x3D; langs.length-1; i &gt;&#x3D; 0; i--) {
          100:             if (langs[i] &#x3D;&#x3D; null) continue;
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          97:         ObjectNode translations &#x3D; null;
          98:         String bestLang &#x3D; null;
          99:         for (int i &#x3D; langs.length-1; i &gt;&#x3D; 0; i--) {
          100:             if (langs[i] &#x3D;&#x3D; null) continue;
          101:             ObjectNode json &#x3D; loadLanguage(this.servlet, modname, langs[i]);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          97:         ObjectNode translations &#x3D; null;
          98:         String bestLang &#x3D; null;
          99:         for (int i &#x3D; langs.length-1; i &gt;&#x3D; 0; i--) {
          100:             if (langs[i] &#x3D;&#x3D; null) continue;
          101:             ObjectNode json &#x3D; loadLanguage(this.servlet, modname, langs[i]);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          122:         	logger.error(&quot;Failed to load any language files&quot;);
          123:         }
          124:     }
          125:     
          126:     static ObjectNode loadLanguage(RefineServlet servlet, String modname, String lang) throws UnsupportedEncodingException {
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          125:     
          126:     static ObjectNode loadLanguage(RefineServlet servlet, String modname, String lang) throws UnsupportedEncodingException {
          127:         
          128:         ButterflyModule module &#x3D; servlet.getModule(modname);
          129:         File langFile &#x3D; new File(module.getPath(), &quot;langs&quot; + File.separator + &quot;translation-&quot; + lang + &quot;.json&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          125:     
          126:     static ObjectNode loadLanguage(RefineServlet servlet, String modname, String lang) throws UnsupportedEncodingException {
          127:         
          128:         ButterflyModule module &#x3D; servlet.getModule(modname);
          129:         File langFile &#x3D; new File(module.getPath(), &quot;langs&quot; + File.separator + &quot;translation-&quot; + lang + &quot;.json&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          125:     
          126:     static ObjectNode loadLanguage(RefineServlet servlet, String modname, String lang) throws UnsupportedEncodingException {
          127:         
          128:         ButterflyModule module &#x3D; servlet.getModule(modname);
          129:         File langFile &#x3D; new File(module.getPath(), &quot;langs&quot; + File.separator + &quot;translation-&quot; + lang + &quot;.json&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          125:     
          126:     static ObjectNode loadLanguage(RefineServlet servlet, String modname, String lang) throws UnsupportedEncodingException {
          127:         
          128:         ButterflyModule module &#x3D; servlet.getModule(modname);
          129:         File langFile &#x3D; new File(module.getPath(), &quot;langs&quot; + File.separator + &quot;translation-&quot; + lang + &quot;.json&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          127:         
          128:         ButterflyModule module &#x3D; servlet.getModule(modname);
          129:         File langFile &#x3D; new File(module.getPath(), &quot;langs&quot; + File.separator + &quot;translation-&quot; + lang + &quot;.json&quot;);
          130:         try {
          131:             Reader reader &#x3D; new BufferedReader(new InputStreamReader(new FileInputStream(langFile), &quot;UTF-8&quot;));
          </code></pre>
                              <div>File location: test-code-src/LoadLanguageCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          127:         
          128:         ButterflyModule module &#x3D; servlet.getModule(modname);
          129:         File langFile &#x3D; new File(module.getPath(), &quot;langs&quot; + File.separator + &quot;translation-&quot; + lang + &quot;.json&quot;);
          130:         try {
          131:             Reader reader &#x3D; new BufferedReader(new InputStreamReader(new FileInputStream(langFile), &quot;UTF-8&quot;));
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/PT
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--high">
                      <span class="label__text">high severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Sensitive Cookie in HTTPS Session Without &#x27;Secure&#x27; Attribute</p>
                          <!--Rule ID: java/WebCookieWithSecureFalse</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-614</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/LoginCommand.java (line : 247)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          243:         Cookie cookie &#x3D; new Cookie(key, encodedValue);
          244:         cookie.setMaxAge(60 * 60 * 24 * 365); // a year
          245:         cookie.setPath(&quot;/&quot;);
          246:         // set to false because OpenRefine doesn&#x27;t require HTTPS
          247:         cookie.setSecure(false);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>The cookie&#x27;s Secure flag is set to setSecure. Set it to true to protect the cookie from man-in-the-middle attacks.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          243:         Cookie cookie &#x3D; new Cookie(key, encodedValue);
          244:         cookie.setMaxAge(60 * 60 * 24 * 365); // a year
          245:         cookie.setPath(&quot;/&quot;);
          246:         // set to false because OpenRefine doesn&#x27;t require HTTPS
          247:         cookie.setSecure(false);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/WebCookieWithSecureFalse
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--high">
                      <span class="label__text">high severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Sensitive Cookie in HTTPS Session Without &#x27;Secure&#x27; Attribute</p>
                          <!--Rule ID: java/WebCookieWithSecureFalse</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-614</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/LoginCommand.java (line : 255)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          251:     private static void removeCookie(HttpServletResponse response, String key) {
          252:         Cookie cookie &#x3D; new Cookie(key, &quot;&quot;);
          253:         cookie.setMaxAge(0); // 0 causes the cookie to be deleted
          254:         cookie.setPath(&quot;/&quot;);
          255:         cookie.setSecure(false);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>The cookie&#x27;s Secure flag is set to setSecure. Set it to true to protect the cookie from man-in-the-middle attacks.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          251:     private static void removeCookie(HttpServletResponse response, String key) {
          252:         Cookie cookie &#x3D; new Cookie(key, &quot;&quot;);
          253:         cookie.setMaxAge(0); // 0 causes the cookie to be deleted
          254:         cookie.setPath(&quot;/&quot;);
          255:         cookie.setSecure(false);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/WebCookieWithSecureFalse
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--high">
                      <span class="label__text">high severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Cross-site Scripting (XSS)</p>
                          <!--Rule ID: java/XSS</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-79</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/GetRowsCommand.java (line : 165)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          161:             response.setHeader(&quot;Content-Type&quot;, callback &#x3D;&#x3D; null ? &quot;application/json&quot; : &quot;text/javascript&quot;);
          162:             
          163:             PrintWriter writer &#x3D; response.getWriter();
          164:             if (callback !&#x3D; null) {
          165:                 writer.write(callback);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Unsanitized input from an HTTP parameter flows into write, where it is used to render an HTML page returned to the user. This may result in a Cross-Site Scripting attack (XSS).</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/GetRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          145:                 project &#x3D; getProject(request);
          146:             }
          147:             
          148:             Engine engine &#x3D; getEngine(request, project);
          149:             String callback &#x3D; request.getParameter(&quot;callback&quot;);
          </code></pre>
                              <div>File location: test-code-src/GetRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          145:                 project &#x3D; getProject(request);
          146:             }
          147:             
          148:             Engine engine &#x3D; getEngine(request, project);
          149:             String callback &#x3D; request.getParameter(&quot;callback&quot;);
          </code></pre>
                              <div>File location: test-code-src/GetRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          145:                 project &#x3D; getProject(request);
          146:             }
          147:             
          148:             Engine engine &#x3D; getEngine(request, project);
          149:             String callback &#x3D; request.getParameter(&quot;callback&quot;);
          </code></pre>
                              <div>File location: test-code-src/GetRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          161:             response.setHeader(&quot;Content-Type&quot;, callback &#x3D;&#x3D; null ? &quot;application/json&quot; : &quot;text/javascript&quot;);
          162:             
          163:             PrintWriter writer &#x3D; response.getWriter();
          164:             if (callback !&#x3D; null) {
          165:                 writer.write(callback);
          </code></pre>
                              <div>File location: test-code-src/GetRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          161:             response.setHeader(&quot;Content-Type&quot;, callback &#x3D;&#x3D; null ? &quot;application/json&quot; : &quot;text/javascript&quot;);
          162:             
          163:             PrintWriter writer &#x3D; response.getWriter();
          164:             if (callback !&#x3D; null) {
          165:                 writer.write(callback);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/XSS
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--high">
                      <span class="label__text">high severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Cross-site Scripting (XSS)</p>
                          <!--Rule ID: java/XSS</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-79</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/SavedConnectionCommand.java (line : 100)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          96:         
          97:         DatabaseConfiguration savedConn &#x3D; DatabaseUtils.getSavedConnection(connectionName);
          98:         if(savedConn &#x3D;&#x3D; null) {
          99:             //logger.error(&quot;Connection With name:: {} does not exist!&quot;, request.getParameter(&quot;connectionName&quot;));
          100:             response.sendError(HttpStatus.SC_BAD_REQUEST, &quot;Connection with name &quot; + connectionName + &quot; does not exists!&quot;);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Unsanitized input from an HTTP parameter flows into sendError, where it is used to render an HTML page returned to the user. This may result in a Cross-Site Scripting attack (XSS).</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/SavedConnectionCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          91:         if(logger.isDebugEnabled()) {
          92:             logger.debug(&quot;SavedConnectionCommand::Delete Connection: {}&quot;, request.getParameter(&quot;connectionName&quot;));
          93:         }
          94: 
          95:         String connectionName  &#x3D; request.getParameter(&quot;connectionName&quot;);
          </code></pre>
                              <div>File location: test-code-src/SavedConnectionCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          91:         if(logger.isDebugEnabled()) {
          92:             logger.debug(&quot;SavedConnectionCommand::Delete Connection: {}&quot;, request.getParameter(&quot;connectionName&quot;));
          93:         }
          94: 
          95:         String connectionName  &#x3D; request.getParameter(&quot;connectionName&quot;);
          </code></pre>
                              <div>File location: test-code-src/SavedConnectionCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          91:         if(logger.isDebugEnabled()) {
          92:             logger.debug(&quot;SavedConnectionCommand::Delete Connection: {}&quot;, request.getParameter(&quot;connectionName&quot;));
          93:         }
          94: 
          95:         String connectionName  &#x3D; request.getParameter(&quot;connectionName&quot;);
          </code></pre>
                              <div>File location: test-code-src/SavedConnectionCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          96:         
          97:         DatabaseConfiguration savedConn &#x3D; DatabaseUtils.getSavedConnection(connectionName);
          98:         if(savedConn &#x3D;&#x3D; null) {
          99:             //logger.error(&quot;Connection With name:: {} does not exist!&quot;, request.getParameter(&quot;connectionName&quot;));
          100:             response.sendError(HttpStatus.SC_BAD_REQUEST, &quot;Connection with name &quot; + connectionName + &quot; does not exists!&quot;);
          </code></pre>
                              <div>File location: test-code-src/SavedConnectionCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          96:         
          97:         DatabaseConfiguration savedConn &#x3D; DatabaseUtils.getSavedConnection(connectionName);
          98:         if(savedConn &#x3D;&#x3D; null) {
          99:             //logger.error(&quot;Connection With name:: {} does not exist!&quot;, request.getParameter(&quot;connectionName&quot;));
          100:             response.sendError(HttpStatus.SC_BAD_REQUEST, &quot;Connection with name &quot; + connectionName + &quot; does not exists!&quot;);
          </code></pre>
                              <div>File location: test-code-src/SavedConnectionCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          96:         
          97:         DatabaseConfiguration savedConn &#x3D; DatabaseUtils.getSavedConnection(connectionName);
          98:         if(savedConn &#x3D;&#x3D; null) {
          99:             //logger.error(&quot;Connection With name:: {} does not exist!&quot;, request.getParameter(&quot;connectionName&quot;));
          100:             response.sendError(HttpStatus.SC_BAD_REQUEST, &quot;Connection with name &quot; + connectionName + &quot; does not exists!&quot;);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/XSS
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--medium">
                      <span class="label__text">medium severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Sensitive Cookie Without &#x27;HttpOnly&#x27; Flag</p>
                          <!--Rule ID: java/WebCookieMissesCallToSetHttpOnly</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-1004</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/CookiesUtilities.java (line : 62)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          58:         return cookie;
          59:     }
          60: 
          61:     public static void setCookie(HttpServletRequest request, HttpServletResponse response, String name, String value, int max_age) {
          62:         Cookie c &#x3D; new Cookie(name, value);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Cookie misses a call to setHttpOnly. Set the HttpOnly flag to true to protect the cookie from possible malicious code on client side.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/CookiesUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          58:         return cookie;
          59:     }
          60: 
          61:     public static void setCookie(HttpServletRequest request, HttpServletResponse response, String name, String value, int max_age) {
          62:         Cookie c &#x3D; new Cookie(name, value);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/WebCookieMissesCallToSetHttpOnly
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--medium">
                      <span class="label__text">medium severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Sensitive Cookie Without &#x27;HttpOnly&#x27; Flag</p>
                          <!--Rule ID: java/WebCookieMissesCallToSetHttpOnly</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-1004</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/CookiesUtilities.java (line : 70)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          66:         response.addCookie(c);            
          67:     }
          68: 
          69:     public static void deleteCookie(HttpServletRequest request, HttpServletResponse response, String name) {
          70:         Cookie c &#x3D; new Cookie(name, &quot;&quot;);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Cookie misses a call to setHttpOnly. Set the HttpOnly flag to true to protect the cookie from possible malicious code on client side.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/CookiesUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          66:         response.addCookie(c);            
          67:     }
          68: 
          69:     public static void deleteCookie(HttpServletRequest request, HttpServletResponse response, String name) {
          70:         Cookie c &#x3D; new Cookie(name, &quot;&quot;);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/WebCookieMissesCallToSetHttpOnly
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--medium">
                      <span class="label__text">medium severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Sensitive Cookie Without &#x27;HttpOnly&#x27; Flag</p>
                          <!--Rule ID: java/WebCookieMissesCallToSetHttpOnly</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-1004</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/LoginCommand.java (line : 243)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          239:     }
          240: 
          241:     private static void setCookie(HttpServletResponse response, String key, String value) throws UnsupportedEncodingException {
          242:         String encodedValue &#x3D; URLEncoder.encode(value, &quot;utf-8&quot;);
          243:         Cookie cookie &#x3D; new Cookie(key, encodedValue);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Cookie misses a call to setHttpOnly. Set the HttpOnly flag to true to protect the cookie from possible malicious code on client side.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          239:     }
          240: 
          241:     private static void setCookie(HttpServletResponse response, String key, String value) throws UnsupportedEncodingException {
          242:         String encodedValue &#x3D; URLEncoder.encode(value, &quot;utf-8&quot;);
          243:         Cookie cookie &#x3D; new Cookie(key, encodedValue);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/WebCookieMissesCallToSetHttpOnly
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--medium">
                      <span class="label__text">medium severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Sensitive Cookie Without &#x27;HttpOnly&#x27; Flag</p>
                          <!--Rule ID: java/WebCookieMissesCallToSetHttpOnly</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-1004</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/LoginCommand.java (line : 252)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          248:         response.addCookie(cookie);
          249:     }
          250: 
          251:     private static void removeCookie(HttpServletResponse response, String key) {
          252:         Cookie cookie &#x3D; new Cookie(key, &quot;&quot;);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Cookie misses a call to setHttpOnly. Set the HttpOnly flag to true to protect the cookie from possible malicious code on client side.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          248:         response.addCookie(cookie);
          249:     }
          250: 
          251:     private static void removeCookie(HttpServletResponse response, String key) {
          252:         Cookie cookie &#x3D; new Cookie(key, &quot;&quot;);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/WebCookieMissesCallToSetHttpOnly
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--medium">
                      <span class="label__text">medium severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Improper Neutralization of CRLF Sequences in HTTP Headers</p>
                          <!--Rule ID: java/HttpResponseSplitting</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-113</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/ExportRowsCommand.java (line : 102)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          98:             String contentType &#x3D; params.getProperty(&quot;contentType&quot;);
          99:             if (contentType &#x3D;&#x3D; null) {
          100:                 contentType &#x3D; exporter.getContentType();
          101:             }
          102:             response.setHeader(&quot;Content-Type&quot;, contentType);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Unsanitized input from an HTTP parameter flows into setHeader and reaches an HTTP header returned to the user. This may allow a malicious input that contain CR/LF to split the http response into two responses and the second response to be controlled by the attacker. This may be used to mount a range of attacks such as cross-site scripting or cache poisoning.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          69:     @SuppressWarnings(&quot;unchecked&quot;)
          70:     static public Properties getRequestParameters(HttpServletRequest request) {
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          69:     @SuppressWarnings(&quot;unchecked&quot;)
          70:     static public Properties getRequestParameters(HttpServletRequest request) {
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          69:     @SuppressWarnings(&quot;unchecked&quot;)
          70:     static public Properties getRequestParameters(HttpServletRequest request) {
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          70:     static public Properties getRequestParameters(HttpServletRequest request) {
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          74:         while (en.hasMoreElements()) {
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          74:         while (en.hasMoreElements()) {
          75:             String name &#x3D; en.nextElement();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          74:         while (en.hasMoreElements()) {
          75:             String name &#x3D; en.nextElement();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          71:         Properties options &#x3D; new Properties();
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          74:         while (en.hasMoreElements()) {
          75:             String name &#x3D; en.nextElement();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          74:         while (en.hasMoreElements()) {
          75:             String name &#x3D; en.nextElement();
          76:             options.put(name, request.getParameter(name));
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          72: 
          73:         Enumeration&lt;String&gt; en &#x3D; request.getParameterNames();
          74:         while (en.hasMoreElements()) {
          75:             String name &#x3D; en.nextElement();
          76:             options.put(name, request.getParameter(name));
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          74:         while (en.hasMoreElements()) {
          75:             String name &#x3D; en.nextElement();
          76:             options.put(name, request.getParameter(name));
          77:         }
          78:         return options;
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          86:        
          87:         try {
          88:             Project project &#x3D; getProject(request);
          89:             Engine engine &#x3D; getEngine(request, project);
          90:             Properties params &#x3D; getRequestParameters(request);
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          88:             Project project &#x3D; getProject(request);
          89:             Engine engine &#x3D; getEngine(request, project);
          90:             Properties params &#x3D; getRequestParameters(request);
          91:             
          92:             String format &#x3D; params.getProperty(&quot;format&quot;);
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          94:             if (exporter &#x3D;&#x3D; null) {
          95:                 exporter &#x3D; new CsvExporter(&#x27;\t&#x27;);
          96:             }
          97:             
          98:             String contentType &#x3D; params.getProperty(&quot;contentType&quot;);
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          94:             if (exporter &#x3D;&#x3D; null) {
          95:                 exporter &#x3D; new CsvExporter(&#x27;\t&#x27;);
          96:             }
          97:             
          98:             String contentType &#x3D; params.getProperty(&quot;contentType&quot;);
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          94:             if (exporter &#x3D;&#x3D; null) {
          95:                 exporter &#x3D; new CsvExporter(&#x27;\t&#x27;);
          96:             }
          97:             
          98:             String contentType &#x3D; params.getProperty(&quot;contentType&quot;);
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          98:             String contentType &#x3D; params.getProperty(&quot;contentType&quot;);
          99:             if (contentType &#x3D;&#x3D; null) {
          100:                 contentType &#x3D; exporter.getContentType();
          101:             }
          102:             response.setHeader(&quot;Content-Type&quot;, contentType);
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          98:             String contentType &#x3D; params.getProperty(&quot;contentType&quot;);
          99:             if (contentType &#x3D;&#x3D; null) {
          100:                 contentType &#x3D; exporter.getContentType();
          101:             }
          102:             response.setHeader(&quot;Content-Type&quot;, contentType);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/HttpResponseSplitting
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--medium">
                      <span class="label__text">medium severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Improper Neutralization of CRLF Sequences in HTTP Headers</p>
                          <!--Rule ID: java/HttpResponseSplitting</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-113</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/ExportRowsCommand.java (line : 108)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          104:             String preview &#x3D; params.getProperty(&quot;preview&quot;);
          105:             if (!&quot;true&quot;.equals(preview)) {
          106:                 String path &#x3D; request.getPathInfo();
          107:                 String filename &#x3D; path.substring(path.lastIndexOf(&#x27;/&#x27;) + 1);
          108:                 response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment; filename&#x3D;&quot; + filename);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Unsanitized input from the request URL flows into setHeader and reaches an HTTP header returned to the user. This may allow a malicious input that contain CR/LF to split the http response into two responses and the second response to be controlled by the attacker. This may be used to mount a range of attacks such as cross-site scripting or cache poisoning.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          102:             response.setHeader(&quot;Content-Type&quot;, contentType);
          103: 
          104:             String preview &#x3D; params.getProperty(&quot;preview&quot;);
          105:             if (!&quot;true&quot;.equals(preview)) {
          106:                 String path &#x3D; request.getPathInfo();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          102:             response.setHeader(&quot;Content-Type&quot;, contentType);
          103: 
          104:             String preview &#x3D; params.getProperty(&quot;preview&quot;);
          105:             if (!&quot;true&quot;.equals(preview)) {
          106:                 String path &#x3D; request.getPathInfo();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          102:             response.setHeader(&quot;Content-Type&quot;, contentType);
          103: 
          104:             String preview &#x3D; params.getProperty(&quot;preview&quot;);
          105:             if (!&quot;true&quot;.equals(preview)) {
          106:                 String path &#x3D; request.getPathInfo();
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          103: 
          104:             String preview &#x3D; params.getProperty(&quot;preview&quot;);
          105:             if (!&quot;true&quot;.equals(preview)) {
          106:                 String path &#x3D; request.getPathInfo();
          107:                 String filename &#x3D; path.substring(path.lastIndexOf(&#x27;/&#x27;) + 1);
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          103: 
          104:             String preview &#x3D; params.getProperty(&quot;preview&quot;);
          105:             if (!&quot;true&quot;.equals(preview)) {
          106:                 String path &#x3D; request.getPathInfo();
          107:                 String filename &#x3D; path.substring(path.lastIndexOf(&#x27;/&#x27;) + 1);
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          103: 
          104:             String preview &#x3D; params.getProperty(&quot;preview&quot;);
          105:             if (!&quot;true&quot;.equals(preview)) {
          106:                 String path &#x3D; request.getPathInfo();
          107:                 String filename &#x3D; path.substring(path.lastIndexOf(&#x27;/&#x27;) + 1);
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          103: 
          104:             String preview &#x3D; params.getProperty(&quot;preview&quot;);
          105:             if (!&quot;true&quot;.equals(preview)) {
          106:                 String path &#x3D; request.getPathInfo();
          107:                 String filename &#x3D; path.substring(path.lastIndexOf(&#x27;/&#x27;) + 1);
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          104:             String preview &#x3D; params.getProperty(&quot;preview&quot;);
          105:             if (!&quot;true&quot;.equals(preview)) {
          106:                 String path &#x3D; request.getPathInfo();
          107:                 String filename &#x3D; path.substring(path.lastIndexOf(&#x27;/&#x27;) + 1);
          108:                 response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment; filename&#x3D;&quot; + filename);
          </code></pre>
                              <div>File location: test-code-src/ExportRowsCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          104:             String preview &#x3D; params.getProperty(&quot;preview&quot;);
          105:             if (!&quot;true&quot;.equals(preview)) {
          106:                 String path &#x3D; request.getPathInfo();
          107:                 String filename &#x3D; path.substring(path.lastIndexOf(&#x27;/&#x27;) + 1);
          108:                 response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment; filename&#x3D;&quot; + filename);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/HttpResponseSplitting
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--medium">
                      <span class="label__text">medium severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Improper Neutralization of CRLF Sequences in HTTP Headers</p>
                          <!--Rule ID: java/HttpResponseSplitting</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-113</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/LoginCommand.java (line : 248)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          244:         cookie.setMaxAge(60 * 60 * 24 * 365); // a year
          245:         cookie.setPath(&quot;/&quot;);
          246:         // set to false because OpenRefine doesn&#x27;t require HTTPS
          247:         cookie.setSecure(false);
          248:         response.addCookie(cookie);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Unsanitized input from cookies flows into addCookie and reaches an HTTP header returned to the user. This may allow a malicious input that contain CR/LF to split the http response into two responses and the second response to be controlled by the attacker. This may be used to mount a range of attacks such as cross-site scripting or cache poisoning.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          106:         if (isBlank(username) &amp;&amp; isBlank(password) &amp;&amp; isBlank(consumerToken)
          107:                 &amp;&amp; isBlank(consumerSecret) &amp;&amp; isBlank(accessToken) &amp;&amp; isBlank(accessSecret)) {
          108:             // In this case, we use cookies to login, and we will always remember the credentials in cookies.
          109:             remember &#x3D; true;
          110:             Map&lt;String, String&gt; cookieMap &#x3D; processCookiesWithPrefix(mediawikiApiEndpointPrefix, request.getCookies());
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          106:         if (isBlank(username) &amp;&amp; isBlank(password) &amp;&amp; isBlank(consumerToken)
          107:                 &amp;&amp; isBlank(consumerSecret) &amp;&amp; isBlank(accessToken) &amp;&amp; isBlank(accessSecret)) {
          108:             // In this case, we use cookies to login, and we will always remember the credentials in cookies.
          109:             remember &#x3D; true;
          110:             Map&lt;String, String&gt; cookieMap &#x3D; processCookiesWithPrefix(mediawikiApiEndpointPrefix, request.getCookies());
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          205:      * 2. Removes the prefix
          206:      */
          207:     private static Map&lt;String, String&gt; processCookiesWithPrefix(String prefix, Cookie[] cookies) throws UnsupportedEncodingException {
          208:         Map&lt;String, String&gt; result &#x3D; new HashMap&lt;&gt;();
          209:         for (Cookie cookie : cookies) {
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          206:      */
          207:     private static Map&lt;String, String&gt; processCookiesWithPrefix(String prefix, Cookie[] cookies) throws UnsupportedEncodingException {
          208:         Map&lt;String, String&gt; result &#x3D; new HashMap&lt;&gt;();
          209:         for (Cookie cookie : cookies) {
          210:             String name &#x3D; cookie.getName();
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          208:         Map&lt;String, String&gt; result &#x3D; new HashMap&lt;&gt;();
          209:         for (Cookie cookie : cookies) {
          210:             String name &#x3D; cookie.getName();
          211:             if (name.startsWith(prefix)) {
          212:                 result.put(name.substring(prefix.length()), getCookieValue(cookie));
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          208:         Map&lt;String, String&gt; result &#x3D; new HashMap&lt;&gt;();
          209:         for (Cookie cookie : cookies) {
          210:             String name &#x3D; cookie.getName();
          211:             if (name.startsWith(prefix)) {
          212:                 result.put(name.substring(prefix.length()), getCookieValue(cookie));
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          212:                 result.put(name.substring(prefix.length()), getCookieValue(cookie));
          213:             }
          214:         }
          215: 
          216:         return result;
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          106:         if (isBlank(username) &amp;&amp; isBlank(password) &amp;&amp; isBlank(consumerToken)
          107:                 &amp;&amp; isBlank(consumerSecret) &amp;&amp; isBlank(accessToken) &amp;&amp; isBlank(accessSecret)) {
          108:             // In this case, we use cookies to login, and we will always remember the credentials in cookies.
          109:             remember &#x3D; true;
          110:             Map&lt;String, String&gt; cookieMap &#x3D; processCookiesWithPrefix(mediawikiApiEndpointPrefix, request.getCookies());
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          107:                 &amp;&amp; isBlank(consumerSecret) &amp;&amp; isBlank(accessToken) &amp;&amp; isBlank(accessSecret)) {
          108:             // In this case, we use cookies to login, and we will always remember the credentials in cookies.
          109:             remember &#x3D; true;
          110:             Map&lt;String, String&gt; cookieMap &#x3D; processCookiesWithPrefix(mediawikiApiEndpointPrefix, request.getCookies());
          111:             username &#x3D; cookieMap.get(USERNAME);
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          108:             // In this case, we use cookies to login, and we will always remember the credentials in cookies.
          109:             remember &#x3D; true;
          110:             Map&lt;String, String&gt; cookieMap &#x3D; processCookiesWithPrefix(mediawikiApiEndpointPrefix, request.getCookies());
          111:             username &#x3D; cookieMap.get(USERNAME);
          112:             consumerToken &#x3D; cookieMap.get(CONSUMER_TOKEN);
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          108:             // In this case, we use cookies to login, and we will always remember the credentials in cookies.
          109:             remember &#x3D; true;
          110:             Map&lt;String, String&gt; cookieMap &#x3D; processCookiesWithPrefix(mediawikiApiEndpointPrefix, request.getCookies());
          111:             username &#x3D; cookieMap.get(USERNAME);
          112:             consumerToken &#x3D; cookieMap.get(CONSUMER_TOKEN);
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          108:             // In this case, we use cookies to login, and we will always remember the credentials in cookies.
          109:             remember &#x3D; true;
          110:             Map&lt;String, String&gt; cookieMap &#x3D; processCookiesWithPrefix(mediawikiApiEndpointPrefix, request.getCookies());
          111:             username &#x3D; cookieMap.get(USERNAME);
          112:             consumerToken &#x3D; cookieMap.get(CONSUMER_TOKEN);
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          157:             }
          158:             removeOwnerOnlyConsumerCookies(mediawikiApiEndpointPrefix, request, response);
          159:         } else if (isNotBlank(consumerToken) &amp;&amp; isNotBlank(consumerSecret) &amp;&amp; isNotBlank(accessToken) &amp;&amp; isNotBlank(accessSecret)) {
          160:             if (manager.login(mediawikiApiEndpoint, consumerToken, consumerSecret, accessToken, accessSecret) &amp;&amp; remember) {
          161:                 setCookie(response, mediawikiApiEndpointPrefix + CONSUMER_TOKEN, consumerToken);
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          237:     static String getCookieValue(Cookie cookie) throws UnsupportedEncodingException {
          238:         return URLDecoder.decode(cookie.getValue(), &quot;utf-8&quot;);
          239:     }
          240: 
          241:     private static void setCookie(HttpServletResponse response, String key, String value) throws UnsupportedEncodingException {
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          238:         return URLDecoder.decode(cookie.getValue(), &quot;utf-8&quot;);
          239:     }
          240: 
          241:     private static void setCookie(HttpServletResponse response, String key, String value) throws UnsupportedEncodingException {
          242:         String encodedValue &#x3D; URLEncoder.encode(value, &quot;utf-8&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          238:         return URLDecoder.decode(cookie.getValue(), &quot;utf-8&quot;);
          239:     }
          240: 
          241:     private static void setCookie(HttpServletResponse response, String key, String value) throws UnsupportedEncodingException {
          242:         String encodedValue &#x3D; URLEncoder.encode(value, &quot;utf-8&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          239:     }
          240: 
          241:     private static void setCookie(HttpServletResponse response, String key, String value) throws UnsupportedEncodingException {
          242:         String encodedValue &#x3D; URLEncoder.encode(value, &quot;utf-8&quot;);
          243:         Cookie cookie &#x3D; new Cookie(key, encodedValue);
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          239:     }
          240: 
          241:     private static void setCookie(HttpServletResponse response, String key, String value) throws UnsupportedEncodingException {
          242:         String encodedValue &#x3D; URLEncoder.encode(value, &quot;utf-8&quot;);
          243:         Cookie cookie &#x3D; new Cookie(key, encodedValue);
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          240: 
          241:     private static void setCookie(HttpServletResponse response, String key, String value) throws UnsupportedEncodingException {
          242:         String encodedValue &#x3D; URLEncoder.encode(value, &quot;utf-8&quot;);
          243:         Cookie cookie &#x3D; new Cookie(key, encodedValue);
          244:         cookie.setMaxAge(60 * 60 * 24 * 365); // a year
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          241:     private static void setCookie(HttpServletResponse response, String key, String value) throws UnsupportedEncodingException {
          242:         String encodedValue &#x3D; URLEncoder.encode(value, &quot;utf-8&quot;);
          243:         Cookie cookie &#x3D; new Cookie(key, encodedValue);
          244:         cookie.setMaxAge(60 * 60 * 24 * 365); // a year
          245:         cookie.setPath(&quot;/&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          243:         Cookie cookie &#x3D; new Cookie(key, encodedValue);
          244:         cookie.setMaxAge(60 * 60 * 24 * 365); // a year
          245:         cookie.setPath(&quot;/&quot;);
          246:         // set to false because OpenRefine doesn&#x27;t require HTTPS
          247:         cookie.setSecure(false);
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          244:         cookie.setMaxAge(60 * 60 * 24 * 365); // a year
          245:         cookie.setPath(&quot;/&quot;);
          246:         // set to false because OpenRefine doesn&#x27;t require HTTPS
          247:         cookie.setSecure(false);
          248:         response.addCookie(cookie);
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          244:         cookie.setMaxAge(60 * 60 * 24 * 365); // a year
          245:         cookie.setPath(&quot;/&quot;);
          246:         // set to false because OpenRefine doesn&#x27;t require HTTPS
          247:         cookie.setSecure(false);
          248:         response.addCookie(cookie);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/HttpResponseSplitting
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--medium">
                      <span class="label__text">medium severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Improper Neutralization of CRLF Sequences in HTTP Headers</p>
                          <!--Rule ID: java/HttpResponseSplitting</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-113</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/LoginCommand.java (line : 256)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          252:         Cookie cookie &#x3D; new Cookie(key, &quot;&quot;);
          253:         cookie.setMaxAge(0); // 0 causes the cookie to be deleted
          254:         cookie.setPath(&quot;/&quot;);
          255:         cookie.setSecure(false);
          256:         response.addCookie(cookie);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Unsanitized input from cookies flows into addCookie and reaches an HTTP header returned to the user. This may allow a malicious input that contain CR/LF to split the http response into two responses and the second response to be controlled by the attacker. This may be used to mount a range of attacks such as cross-site scripting or cache poisoning.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          217:     }
          218: 
          219:     private static void removeUsernamePasswordCookies(String wikibaseApiEndpointPrefix, HttpServletRequest request, HttpServletResponse response) {
          220:         String toRemovePrefix &#x3D; wikibaseApiEndpointPrefix + WIKIBASE_COOKIE_PREFIX;
          221:         Cookie[] cookies &#x3D; request.getCookies();
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          217:     }
          218: 
          219:     private static void removeUsernamePasswordCookies(String wikibaseApiEndpointPrefix, HttpServletRequest request, HttpServletResponse response) {
          220:         String toRemovePrefix &#x3D; wikibaseApiEndpointPrefix + WIKIBASE_COOKIE_PREFIX;
          221:         Cookie[] cookies &#x3D; request.getCookies();
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          218: 
          219:     private static void removeUsernamePasswordCookies(String wikibaseApiEndpointPrefix, HttpServletRequest request, HttpServletResponse response) {
          220:         String toRemovePrefix &#x3D; wikibaseApiEndpointPrefix + WIKIBASE_COOKIE_PREFIX;
          221:         Cookie[] cookies &#x3D; request.getCookies();
          222:         for (Cookie cookie : cookies) {
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          219:     private static void removeUsernamePasswordCookies(String wikibaseApiEndpointPrefix, HttpServletRequest request, HttpServletResponse response) {
          220:         String toRemovePrefix &#x3D; wikibaseApiEndpointPrefix + WIKIBASE_COOKIE_PREFIX;
          221:         Cookie[] cookies &#x3D; request.getCookies();
          222:         for (Cookie cookie : cookies) {
          223:             if (cookie.getName().startsWith(toRemovePrefix)) {
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          220:         String toRemovePrefix &#x3D; wikibaseApiEndpointPrefix + WIKIBASE_COOKIE_PREFIX;
          221:         Cookie[] cookies &#x3D; request.getCookies();
          222:         for (Cookie cookie : cookies) {
          223:             if (cookie.getName().startsWith(toRemovePrefix)) {
          224:                 removeCookie(response, cookie.getName());
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          220:         String toRemovePrefix &#x3D; wikibaseApiEndpointPrefix + WIKIBASE_COOKIE_PREFIX;
          221:         Cookie[] cookies &#x3D; request.getCookies();
          222:         for (Cookie cookie : cookies) {
          223:             if (cookie.getName().startsWith(toRemovePrefix)) {
          224:                 removeCookie(response, cookie.getName());
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          247:         cookie.setSecure(false);
          248:         response.addCookie(cookie);
          249:     }
          250: 
          251:     private static void removeCookie(HttpServletResponse response, String key) {
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          248:         response.addCookie(cookie);
          249:     }
          250: 
          251:     private static void removeCookie(HttpServletResponse response, String key) {
          252:         Cookie cookie &#x3D; new Cookie(key, &quot;&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          248:         response.addCookie(cookie);
          249:     }
          250: 
          251:     private static void removeCookie(HttpServletResponse response, String key) {
          252:         Cookie cookie &#x3D; new Cookie(key, &quot;&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          249:     }
          250: 
          251:     private static void removeCookie(HttpServletResponse response, String key) {
          252:         Cookie cookie &#x3D; new Cookie(key, &quot;&quot;);
          253:         cookie.setMaxAge(0); // 0 causes the cookie to be deleted
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          250: 
          251:     private static void removeCookie(HttpServletResponse response, String key) {
          252:         Cookie cookie &#x3D; new Cookie(key, &quot;&quot;);
          253:         cookie.setMaxAge(0); // 0 causes the cookie to be deleted
          254:         cookie.setPath(&quot;/&quot;);
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          251:     private static void removeCookie(HttpServletResponse response, String key) {
          252:         Cookie cookie &#x3D; new Cookie(key, &quot;&quot;);
          253:         cookie.setMaxAge(0); // 0 causes the cookie to be deleted
          254:         cookie.setPath(&quot;/&quot;);
          255:         cookie.setSecure(false);
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          252:         Cookie cookie &#x3D; new Cookie(key, &quot;&quot;);
          253:         cookie.setMaxAge(0); // 0 causes the cookie to be deleted
          254:         cookie.setPath(&quot;/&quot;);
          255:         cookie.setSecure(false);
          256:         response.addCookie(cookie);
          </code></pre>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          252:         Cookie cookie &#x3D; new Cookie(key, &quot;&quot;);
          253:         cookie.setMaxAge(0); // 0 causes the cookie to be deleted
          254:         cookie.setPath(&quot;/&quot;);
          255:         cookie.setSecure(false);
          256:         response.addCookie(cookie);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/HttpResponseSplitting
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--medium">
                      <span class="label__text">medium severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Insufficient Session Expiration</p>
                          <!--Rule ID: java/WebCookieTooLongMaxAge</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-613</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/LoginCommand.java (line : 244)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          240: 
          241:     private static void setCookie(HttpServletResponse response, String key, String value) throws UnsupportedEncodingException {
          242:         String encodedValue &#x3D; URLEncoder.encode(value, &quot;utf-8&quot;);
          243:         Cookie cookie &#x3D; new Cookie(key, encodedValue);
          244:         cookie.setMaxAge(60 * 60 * 24 * 365); // a year
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Setting the cookie&#x27;s MaxAge attribute to high values is dangerous because it gives attackers more time to steal sensitive data.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/LoginCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          240: 
          241:     private static void setCookie(HttpServletResponse response, String key, String value) throws UnsupportedEncodingException {
          242:         String encodedValue &#x3D; URLEncoder.encode(value, &quot;utf-8&quot;);
          243:         Cookie cookie &#x3D; new Cookie(key, encodedValue);
          244:         cookie.setMaxAge(60 * 60 * 24 * 365); // a year
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/WebCookieTooLongMaxAge
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--medium">
                      <span class="label__text">medium severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Sensitive Cookie in HTTPS Session Without &#x27;Secure&#x27; Attribute</p>
                          <!--Rule ID: java/WebCookieMissesCallToSetSecure</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-614</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/CookiesUtilities.java (line : 62)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          58:         return cookie;
          59:     }
          60: 
          61:     public static void setCookie(HttpServletRequest request, HttpServletResponse response, String name, String value, int max_age) {
          62:         Cookie c &#x3D; new Cookie(name, value);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Cookie misses a call to setSecure. Set the Secure flag to true to protect the cookie from man-in-the-middle attacks.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/CookiesUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          58:         return cookie;
          59:     }
          60: 
          61:     public static void setCookie(HttpServletRequest request, HttpServletResponse response, String name, String value, int max_age) {
          62:         Cookie c &#x3D; new Cookie(name, value);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/WebCookieMissesCallToSetSecure
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--medium">
                      <span class="label__text">medium severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Sensitive Cookie in HTTPS Session Without &#x27;Secure&#x27; Attribute</p>
                          <!--Rule ID: java/WebCookieMissesCallToSetSecure</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-614</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/CookiesUtilities.java (line : 70)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          66:         response.addCookie(c);            
          67:     }
          68: 
          69:     public static void deleteCookie(HttpServletRequest request, HttpServletResponse response, String name) {
          70:         Cookie c &#x3D; new Cookie(name, &quot;&quot;);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Cookie misses a call to setSecure. Set the Secure flag to true to protect the cookie from man-in-the-middle attacks.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/CookiesUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          66:         response.addCookie(c);            
          67:     }
          68: 
          69:     public static void deleteCookie(HttpServletRequest request, HttpServletResponse response, String name) {
          70:         Cookie c &#x3D; new Cookie(name, &quot;&quot;);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/WebCookieMissesCallToSetSecure
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--medium">
                      <span class="label__text">medium severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Use of Password Hash With Insufficient Computational Effort</p>
                          <!--Rule ID: java/InsecureHash</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-916</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/SHA1.java (line : 51)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          47:     public Object call(Properties bindings, Object[] args) {
          48:         if (args.length &#x3D;&#x3D; 1 &amp;&amp; args[0] !&#x3D; null) {
          49:             Object o &#x3D; args[0];
          50:             String s &#x3D; (o instanceof String) ? (String) o : o.toString();
          51:             return DigestUtils.sha1Hex(s);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>The SHA1 hash (used in org.apache.commons.codec.digest.DigestUtils.sha1Hex) is insecure. Consider changing it to a secure hash algorithm</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/SHA1.java</div>
                              <div>Code:</div>
                              <pre><code>
          47:     public Object call(Properties bindings, Object[] args) {
          48:         if (args.length &#x3D;&#x3D; 1 &amp;&amp; args[0] !&#x3D; null) {
          49:             Object o &#x3D; args[0];
          50:             String s &#x3D; (o instanceof String) ? (String) o : o.toString();
          51:             return DigestUtils.sha1Hex(s);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/InsecureHash
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--medium">
                      <span class="label__text">medium severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Use of Password Hash With Insufficient Computational Effort</p>
                          <!--Rule ID: java/InsecureHash</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-916</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/MD5.java (line : 51)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          47:     public Object call(Properties bindings, Object[] args) {
          48:         if (args.length &#x3D;&#x3D; 1 &amp;&amp; args[0] !&#x3D; null) {
          49:             Object o &#x3D; args[0];
          50:             String s &#x3D; (o instanceof String) ? (String) o : o.toString();
          51:             return DigestUtils.md5Hex(s);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>The MD5 hash (used in org.apache.commons.codec.digest.DigestUtils.md5Hex) is insecure. Consider changing it to a secure hash algorithm</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/MD5.java</div>
                              <div>Code:</div>
                              <pre><code>
          47:     public Object call(Properties bindings, Object[] args) {
          48:         if (args.length &#x3D;&#x3D; 1 &amp;&amp; args[0] !&#x3D; null) {
          49:             Object o &#x3D; args[0];
          50:             String s &#x3D; (o instanceof String) ? (String) o : o.toString();
          51:             return DigestUtils.md5Hex(s);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/InsecureHash
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--medium">
                      <span class="label__text">medium severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Open Redirect</p>
                          <!--Rule ID: java/OR</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-601</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/AuthorizeCommand.java (line : 98)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          94:                     // now redirect the user to the Authorize URL where she can authenticate against the
          95:                     // service provider and authorize us. 
          96:                     // The provider will bounce the user back here for us to continue the dance.
          97:                     
          98:                     response.sendRedirect(url);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Unsanitized input from the request URL flows into sendRedirect, where it is used as an URL to redirect the user. This may result in an Open Redirect vulnerability.</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/OAuthUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          54:         return (name &#x3D;&#x3D; null) ? null : providers.get(name);
          55:     }
          56: 
          57:     public static Provider getProvider(HttpServletRequest request) {
          58:         String path &#x3D; request.getPathInfo().substring(1);
          </code></pre>
                              <div>File location: test-code-src/OAuthUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          54:         return (name &#x3D;&#x3D; null) ? null : providers.get(name);
          55:     }
          56: 
          57:     public static Provider getProvider(HttpServletRequest request) {
          58:         String path &#x3D; request.getPathInfo().substring(1);
          </code></pre>
                              <div>File location: test-code-src/OAuthUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          54:         return (name &#x3D;&#x3D; null) ? null : providers.get(name);
          55:     }
          56: 
          57:     public static Provider getProvider(HttpServletRequest request) {
          58:         String path &#x3D; request.getPathInfo().substring(1);
          </code></pre>
                              <div>File location: test-code-src/OAuthUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          54:         return (name &#x3D;&#x3D; null) ? null : providers.get(name);
          55:     }
          56: 
          57:     public static Provider getProvider(HttpServletRequest request) {
          58:         String path &#x3D; request.getPathInfo().substring(1);
          </code></pre>
                              <div>File location: test-code-src/OAuthUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          55:     }
          56: 
          57:     public static Provider getProvider(HttpServletRequest request) {
          58:         String path &#x3D; request.getPathInfo().substring(1);
          59:         int slash &#x3D; path.lastIndexOf(&#x27;/&#x27;);
          </code></pre>
                              <div>File location: test-code-src/OAuthUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          56: 
          57:     public static Provider getProvider(HttpServletRequest request) {
          58:         String path &#x3D; request.getPathInfo().substring(1);
          59:         int slash &#x3D; path.lastIndexOf(&#x27;/&#x27;);
          60:         String provider_str &#x3D; path.substring(slash + 1);
          </code></pre>
                              <div>File location: test-code-src/OAuthUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          56: 
          57:     public static Provider getProvider(HttpServletRequest request) {
          58:         String path &#x3D; request.getPathInfo().substring(1);
          59:         int slash &#x3D; path.lastIndexOf(&#x27;/&#x27;);
          60:         String provider_str &#x3D; path.substring(slash + 1);
          </code></pre>
                              <div>File location: test-code-src/OAuthUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          56: 
          57:     public static Provider getProvider(HttpServletRequest request) {
          58:         String path &#x3D; request.getPathInfo().substring(1);
          59:         int slash &#x3D; path.lastIndexOf(&#x27;/&#x27;);
          60:         String provider_str &#x3D; path.substring(slash + 1);
          </code></pre>
                              <div>File location: test-code-src/OAuthUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          57:     public static Provider getProvider(HttpServletRequest request) {
          58:         String path &#x3D; request.getPathInfo().substring(1);
          59:         int slash &#x3D; path.lastIndexOf(&#x27;/&#x27;);
          60:         String provider_str &#x3D; path.substring(slash + 1);
          61:         Provider provider &#x3D; getProvider(provider_str);
          </code></pre>
                              <div>File location: test-code-src/OAuthUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          49:         providers.put(provider.getHost(), provider);
          50:         infos.put(provider.getHost(), oauthInfo);
          51:     }
          52:     
          53:     public static Provider getProvider(String name) {
          </code></pre>
                              <div>File location: test-code-src/OAuthUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          50:         infos.put(provider.getHost(), oauthInfo);
          51:     }
          52:     
          53:     public static Provider getProvider(String name) {
          54:         return (name &#x3D;&#x3D; null) ? null : providers.get(name);
          </code></pre>
                              <div>File location: test-code-src/OAuthUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          50:         infos.put(provider.getHost(), oauthInfo);
          51:     }
          52:     
          53:     public static Provider getProvider(String name) {
          54:         return (name &#x3D;&#x3D; null) ? null : providers.get(name);
          </code></pre>
                              <div>File location: test-code-src/OAuthUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          57:     public static Provider getProvider(HttpServletRequest request) {
          58:         String path &#x3D; request.getPathInfo().substring(1);
          59:         int slash &#x3D; path.lastIndexOf(&#x27;/&#x27;);
          60:         String provider_str &#x3D; path.substring(slash + 1);
          61:         Provider provider &#x3D; getProvider(provider_str);
          </code></pre>
                              <div>File location: test-code-src/OAuthUtilities.java</div>
                              <div>Code:</div>
                              <pre><code>
          61:         Provider provider &#x3D; getProvider(provider_str);
          62:         if (provider &#x3D;&#x3D; null) {
          63:             throw new RuntimeException(&quot;Can&#x27;t find OAuth provider &#x27;&quot; + provider_str + &quot;&#x27;&quot;);
          64:         }
          65:         return provider;
          </code></pre>
                              <div>File location: test-code-src/AuthorizeCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          57:     @Override
          58:     public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
          59: 
          60:         // get the provider from the request
          61:         Provider provider &#x3D; OAuthUtilities.getProvider(request);
          </code></pre>
                              <div>File location: test-code-src/AuthorizeCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          57:     @Override
          58:     public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
          59: 
          60:         // get the provider from the request
          61:         Provider provider &#x3D; OAuthUtilities.getProvider(request);
          </code></pre>
                              <div>File location: test-code-src/AuthorizeCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          66:             Credentials access_credentials &#x3D; Credentials.getCredentials(request, provider, Credentials.Type.ACCESS);
          67:                                     
          68:             // prepare the continuation URL that the OAuth provider will redirect the user to
          69:             // (we need to make sure this URL points back to this code or the dance will never complete)
          70:             String callbackURL &#x3D; getBaseURL(request,provider);
          </code></pre>
                              <div>File location: test-code-src/AuthorizeCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          145:         );
          146:         writer.flush();
          147:     }
          148:     
          149:     private String getBaseURL(HttpServletRequest request, Provider provider) {
          </code></pre>
                              <div>File location: test-code-src/AuthorizeCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          162:             } else {
          163:                 throw new RuntimeException(&quot;neither the &#x27;host&#x27; nor &#x27;referer&#x27; headers were present in the HTTP response, I can&#x27;t determine what URL OpenRefine is listening to.&quot;);
          164:             }
          165:         }
          166:         return &quot;http://&quot; + host + &quot;/command/core/authorize/&quot; + provider.getHost();
          </code></pre>
                              <div>File location: test-code-src/AuthorizeCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          75:                 
          76:                 // get the request token credentials
          77:                 Credentials request_credentials &#x3D; Credentials.getCredentials(request, provider, Credentials.Type.REQUEST);
          78: 
          79:                 OAuthConsumer consumer &#x3D; OAuthUtilities.getConsumer(request_credentials, provider);
          </code></pre>
                              <div>File location: test-code-src/AuthorizeCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          75:                 
          76:                 // get the request token credentials
          77:                 Credentials request_credentials &#x3D; Credentials.getCredentials(request, provider, Credentials.Type.REQUEST);
          78: 
          79:                 OAuthConsumer consumer &#x3D; OAuthUtilities.getConsumer(request_credentials, provider);
          </code></pre>
                              <div>File location: test-code-src/AuthorizeCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          83:                     // no credentials were found, so let&#x27;s start the dance
          84: 
          85:                     // get the request token
          86: 
          87:                     String url &#x3D; pp.retrieveRequestToken(consumer, callbackURL);
          </code></pre>
                              <div>File location: test-code-src/AuthorizeCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          83:                     // no credentials were found, so let&#x27;s start the dance
          84: 
          85:                     // get the request token
          86: 
          87:                     String url &#x3D; pp.retrieveRequestToken(consumer, callbackURL);
          </code></pre>
                              <div>File location: test-code-src/AuthorizeCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          94:                     // now redirect the user to the Authorize URL where she can authenticate against the
          95:                     // service provider and authorize us. 
          96:                     // The provider will bounce the user back here for us to continue the dance.
          97:                     
          98:                     response.sendRedirect(url);
          </code></pre>
                              <div>File location: test-code-src/AuthorizeCommand.java</div>
                              <div>Code:</div>
                              <pre><code>
          94:                     // now redirect the user to the Authorize URL where she can authenticate against the
          95:                     // service provider and authorize us. 
          96:                     // The provider will bounce the user back here for us to continue the dance.
          97:                     
          98:                     response.sendRedirect(url);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            java/OR
          </div> -->
        </div><!-- cards -->
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--low" data-snyk-test="low">
              <h2 class="card__title"></h2>
              <div class="card__section">
          
                  <div class="label label--low">
                      <span class="label__text">low severity</span>
                  </div>
          
                  <hr/>
          
                  <ul class="card__meta">
                      <li class="card__meta__item">
                          <p>ID: Cross-site Scripting (XSS)</p>
                          <!--Rule ID: javascript/DOMXSS/test</a> -->
                      </li>
                      <li class="card__meta__item">
                          <p>SNYK-CODE: CWE-79</p>
                      </li>
          
                      <li class="card__meta__item"><p>Found in:
                          test-code-src/big5.html (line : 3234)</p>
                      </li>
                  </ul>
          
                  <hr/>
          
                      <h2>Code Snippet</h2>
                      <pre><code>
          3230: $(function(){
          3231: 
          3232:   //sam�s�ѱM��
          3233:      $.get(&#x27;/book/manage/indexbanner.php?t&#x3D;&#x27; + (new Date()).getTime(),function(content){
          3234: 	  $(&#x27;#bookmange&#x27;).html(content);
          </code></pre>
          
          
                      <h2>Message</h2>
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
          
                      <h2>Data Flow</h2>
                      <ul>
                              <div>File location: test-code-src/big5.html</div>
                              <div>Code:</div>
                              <pre><code>
          3229: &lt;script type&#x3D;&quot;text/JavaScript&quot;&gt;
          3230: $(function(){
          3231: 
          3232:   //sam�s�ѱM��
          3233:      $.get(&#x27;/book/manage/indexbanner.php?t&#x3D;&#x27; + (new Date()).getTime(),function(content){
          </code></pre>
                              <div>File location: test-code-src/big5.html</div>
                              <div>Code:</div>
                              <pre><code>
          3229: &lt;script type&#x3D;&quot;text/JavaScript&quot;&gt;
          3230: $(function(){
          3231: 
          3232:   //sam�s�ѱM��
          3233:      $.get(&#x27;/book/manage/indexbanner.php?t&#x3D;&#x27; + (new Date()).getTime(),function(content){
          </code></pre>
                              <div>File location: test-code-src/big5.html</div>
                              <div>Code:</div>
                              <pre><code>
          3230: $(function(){
          3231: 
          3232:   //sam�s�ѱM��
          3233:      $.get(&#x27;/book/manage/indexbanner.php?t&#x3D;&#x27; + (new Date()).getTime(),function(content){
          3234: 	  $(&#x27;#bookmange&#x27;).html(content);
          </code></pre>
                              <div>File location: test-code-src/big5.html</div>
                              <div>Code:</div>
                              <pre><code>
          3230: $(function(){
          3231: 
          3232:   //sam�s�ѱM��
          3233:      $.get(&#x27;/book/manage/indexbanner.php?t&#x3D;&#x27; + (new Date()).getTime(),function(content){
          3234: 	  $(&#x27;#bookmange&#x27;).html(content);
          </code></pre>
                      </ul>
          
                      <hr/>
              </div><!-- .card__section -->
          
          </div><!-- .card -->
          <!--<div class="layout-container" style="padding-top: 35px;">
            javascript/DOMXSS/test
          </div> -->
        </div><!-- cards -->
    </div>
  </main><!-- .layout-stacked__content -->
</body>

</html>